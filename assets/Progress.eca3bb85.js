var V=(y,t,s)=>new Promise((u,i)=>{var f=l=>{try{b(s.next(l))}catch(g){i(g)}},m=l=>{try{b(s.throw(l))}catch(g){i(g)}},b=l=>l.done?u(l.value):Promise.resolve(l.value).then(f,m);b((s=s.apply(y,t)).next())});import{h as P}from"./index.59b178ec.js";import{_ as F,c as N,b as G}from"./index.2fc0df38.js";import{p as H,r as _,q as E,c as a,a7 as T,P as L,y as c,B as h,F as $,a6 as w,u as r,H as q,I as M,x as v}from"./@vue.7df1a0ef.js";import"./axios.19d3e859.js";import"./vue-router.e129948e.js";import"./@vueuse.fe63d129.js";import"./pinia.685e9614.js";import"./vue-demi.b3a9cad9.js";import"./mitt.550594b0.js";import"./element-plus.54ccd689.js";import"./lodash.8679a684.js";import"./nprogress.5f640c6a.js";import"./async-validator.5d25c98b.js";import"./@popperjs.a8a4a6a0.js";import"./resize-observer-polyfill.8deb1e21.js";import"./lodash-es.4775bb8f.js";import"./dexie.c25c286a.js";import"./@icon-park.87123711.js";const O={class:"dv-percent-pond"},X=["id"],A=["offset","stop-color"],J=["id","x2"],K=["offset","stop-color"],Q=["x","y","rx","ry","stroke-width","stroke","width","height"],U=["stroke-width","stroke-dasharray","stroke","points"],Y=["stroke","fill","x","y"],Z=H({props:{element:null,propValue:null},setup(y){const t=y,s=_(150),u=_(150),i=_(60),f=_(`percent-pond-gradientId1-${N()}`),m=_(`percent-pond-gradientId2-${N()}`),b=o=>{const p=o[0].contentRect;s.value=p.width,u.value=p.height},l=o=>{const n=o;t.propValue.datatag&&n.TagName===t.propValue.datatag&&(i.value=Number((Number(n.TagValue)*100/Number(t.propValue.maxValue)).toFixed(2)))};E(()=>V(this,null,function*(){yield g()}));const g=()=>V(this,null,function*(){if(t.propValue.history)try{const o=yield P.post({url:t.propValue.history,data:[t.propValue.datatag]});o.ErrorCode===200&&(i.value=(Number(o.Results[0].TagValue)||0)*100/Number(t.propValue.maxValue))}catch(o){console.log(o.message||o)}}),e=a(()=>({colors:[t.propValue.color1,t.propValue.color1],borderWidth:Number(t.propValue.borderWidth),borderGap:Number(t.propValue.borderGap),lineDash:t.propValue.lineDash,gapWeight:t.propValue.gapWeight,textColor:t.propValue.textColor,fontSize:Number(t.propValue.fontSize),borderRadius:Number(t.propValue.borderRadius),localGradient:Boolean(t.propValue.localGradient),formatter:t.propValue.formatter})),j=a(()=>e.value.borderWidth?s.value-e.value.borderWidth:0),k=a(()=>e.value.borderWidth?u.value-e.value.borderWidth:0),z=a(()=>e.value?u.value-(e.value.borderWidth+e.value.borderGap)*2:0),S=a(()=>e.value&&e.value.localGradient?f.value:m.value),C=a(()=>{const o=u.value/2;if(!e.value)return`0, ${o} 0, ${o}`;const n=(s.value-(e.value.borderWidth+e.value.borderGap)*2)/100*i.value;return`
        ${e.value.borderWidth+e.value.borderGap}, ${o}
        ${e.value.borderWidth+e.value.borderGap+n}, ${o+.001}`}),W=a(()=>{if(!e.value.colors)return[];const o=e.value.colors.length,n=100/(o-1);return e.value.colors.map((p,d)=>[n*d,p])}),D=a(()=>e.value?"200%":"100%"),B=a(()=>e.value.formatter?e.value.formatter.replace("{value}",i.value.toString()):""),I=a(()=>({fontSize:(t.propValue.fontSize||12)+"px"})),R=o=>{o.key==="maxValue"&&(i.value=Number((Number(o.value)*100/Number(t.propValue.maxValue)).toFixed(2)))};return G(t.element.component+t.element.id,R),G("actual",l),(o,n)=>{const p=T("resize");return L((v(),c("div",O,[(v(),c("svg",null,[h("defs",null,[h("linearGradient",{id:f.value,x1:"0%",y1:"0%",x2:"100%",y2:"0%"},[(v(!0),c($,null,w(r(W),(d,x)=>(v(),c("stop",{key:x,offset:`${d[0]}%`,"stop-color":d[1]},null,8,A))),128))],8,X),h("linearGradient",{id:m.value,x1:"0%",y1:"0%",x2:r(D),y2:"0%"},[(v(!0),c($,null,w(r(W),(d,x)=>(v(),c("stop",{key:x,offset:`${d[0]}%`,"stop-color":d[1]},null,8,K))),128))],8,J)]),h("rect",{x:r(e)?r(e).borderWidth/2:"0",y:r(e)?r(e).borderWidth/2:"0",rx:r(e)?r(e).borderRadius:"0",ry:r(e)?r(e).borderRadius:"0",fill:"transparent","stroke-width":r(e)?r(e).borderWidth:"0",stroke:`url(#${f.value})`,width:r(j)>0?r(j):0,height:r(k)>0?r(k):0},null,8,Q),h("polyline",{"stroke-width":r(z),"stroke-dasharray":r(e)?[r(e).lineDash,r(e).gapWeight].join(","):"0",stroke:`url(#${r(S)})`,points:r(C)},null,8,U),h("text",{style:M(r(I)),stroke:r(e)?r(e).textColor:"#fff",fill:r(e)?r(e).textColor:"#fff",x:s.value/2,y:u.value/2},q(r(B)),13,Y)]))],512)),[[p,b]])}}});var _e=F(Z,[["__scopeId","data-v-14e1621e"]]);export{_e as default};
