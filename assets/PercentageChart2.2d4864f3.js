import{r as W,h as k}from"./echarts.4f9736bc.js";import{b as A}from"./@vueuse.fe63d129.js";import{h as I}from"./index.59b178ec.js";import{u as H}from"./index.2fc0df38.js";import{t as B}from"./mydark.8efe4250.js";import{p as C,r as P,q as _,w,o as E,y as z,x as F}from"./@vue.7df1a0ef.js";import"./zrender.706c9170.js";import"./tslib.34a40861.js";import"./axios.19d3e859.js";import"./vue-router.e129948e.js";import"./pinia.685e9614.js";import"./vue-demi.b3a9cad9.js";import"./mitt.550594b0.js";import"./element-plus.54ccd689.js";import"./lodash.8679a684.js";import"./nprogress.5f640c6a.js";import"./async-validator.5d25c98b.js";import"./@popperjs.a8a4a6a0.js";import"./resize-observer-polyfill.8deb1e21.js";import"./lodash-es.4775bb8f.js";import"./dexie.c25c286a.js";import"./@icon-park.87123711.js";const at=C({props:{element:null,propValue:null},setup(j){const l=j;W("mydark",B);const y=H(),d=P(null);let n=null,a=0,m,f,r=0;_(()=>{v(),clearInterval(m),D(),m=setInterval(M,l.propValue.interval),setTimeout(S,1e3)});function v(){I.get({url:l.propValue.history}).then(e=>{a=e.data||0}).catch(e=>{console.log(e),a=Math.round(Math.random()*100)}).finally(()=>{M()})}A(d,e=>{const s=e[0],{width:i,height:o}=s.contentRect;n==null||n.resize({width:i,height:o})});const x=(e,s,i,o)=>{let t=e+i*Math.cos(o*Math.PI/180),c=s+i*Math.sin(o*Math.PI/180);return{x:t,y:c}},p=()=>{let e=l.propValue.fontSize,s=l.propValue.lineLength;return{title:{text:"{a|"+a+"%}",x:"center",y:"center",textStyle:{rich:{a:{fontSize:e,color:"#29EEF3"},c:{fontSize:20,color:"#29EEF3"}}}},series:[{name:"ring5",type:"custom",coordinateSystem:"none",renderItem:function(o,t){return{type:"arc",shape:{cx:t.getWidth()/2,cy:t.getHeight()/2,r:Math.min(t.getWidth(),t.getHeight())/2*.6,startAngle:(0+r)*Math.PI/180,endAngle:(90+r)*Math.PI/180},style:{stroke:"#0CD3DB",fill:"transparent",lineWidth:1.5},silent:!0}},data:[0]},{name:"ring5",type:"custom",coordinateSystem:"none",renderItem:function(o,t){return{type:"arc",shape:{cx:t.getWidth()/2,cy:t.getHeight()/2,r:Math.min(t.getWidth(),t.getHeight())/2*.6,startAngle:(180+r)*Math.PI/180,endAngle:(270+r)*Math.PI/180},style:{stroke:"#0CD3DB",fill:"transparent",lineWidth:1.5},silent:!0}},data:[0]},{name:"ring5",type:"custom",coordinateSystem:"none",renderItem:function(o,t){return{type:"arc",shape:{cx:t.getWidth()/2,cy:t.getHeight()/2,r:Math.min(t.getWidth(),t.getHeight())/2*.65,startAngle:(270+-r)*Math.PI/180,endAngle:(40+-r)*Math.PI/180},style:{stroke:"#0CD3DB",fill:"transparent",lineWidth:1.5},silent:!0}},data:[0]},{name:"ring5",type:"custom",coordinateSystem:"none",renderItem:function(o,t){return{type:"arc",shape:{cx:t.getWidth()/2,cy:t.getHeight()/2,r:Math.min(t.getWidth(),t.getHeight())/2*.65,startAngle:(90+-r)*Math.PI/180,endAngle:(220+-r)*Math.PI/180},style:{stroke:"#0CD3DB",fill:"transparent",lineWidth:1.5},silent:!0}},data:[0]},{name:"ring5",type:"custom",coordinateSystem:"none",renderItem:function(o,t){let c=t.getWidth()/2,u=t.getHeight()/2,g=Math.min(t.getWidth(),t.getHeight())/2*.65,h=x(c,u,g,90+-r);return{type:"circle",shape:{cx:h.x,cy:h.y,r:4},style:{stroke:"#0CD3DB",fill:"#0CD3DB"},silent:!0}},data:[0]},{name:"ring5",type:"custom",coordinateSystem:"none",renderItem:function(o,t){let c=t.getWidth()/2,u=t.getHeight()/2,g=Math.min(t.getWidth(),t.getHeight())/2*.65,h=x(c,u,g,270+-r);return{type:"circle",shape:{cx:h.x,cy:h.y,r:4},style:{stroke:"#0CD3DB",fill:"#0CD3DB"},silent:!0}},data:[0]},{name:"invent",type:"pie",radius:["58%","45%"],silent:!0,clockwise:!0,startAngle:90,z:0,zlevel:0,label:{normal:{position:"center"}},data:[{value:a,name:"",itemStyle:{color:{colorStops:[{offset:0,color:"#4FADFD"},{offset:1,color:"#28E8FA"}]}}},{value:100-a,name:"",label:{normal:{show:!1}},itemStyle:{color:"#173164"}}]},{name:"",type:"gauge",radius:"58%",center:["50%","50%"],startAngle:0,endAngle:359.9,splitNumber:8,hoverAnimation:!0,axisTick:{show:!1},splitLine:{length:s,lineStyle:{width:5,color:"#061740"}},axisLabel:{show:!1},pointer:{show:!1},axisLine:{lineStyle:{opacity:0}},detail:{show:!1},data:[{value:0,name:""}]}]}},M=()=>{I.get({url:l.propValue.history}).then(e=>{a=e.data||0}).catch(e=>{y.isEditMode&&(a=Math.round(Math.random()*100))}).finally(()=>{let e=a.toFixed(2).split(".")[0],s=a.toFixed(2).split(".")[1];const i="{a|"+e+"}{a|."+s+"%}";n&&n.setOption({title:{text:i}})})},D=()=>{n=k(d.value,"mydark"),n.clear(),n.setOption(p())};y.isEditMode&&w(()=>l.propValue,(e,s)=>{console.log(e),n&&(n.clear(),n.setOption(p()))},{deep:!0});const b=()=>{const e=p();n&&(r=r+3,n.setOption(e,!0))},S=()=>{f=setInterval(b,100)};return E(()=>{clearInterval(m),clearInterval(f),n&&(n.clear(),n.dispose())}),(e,s)=>(F(),z("div",{ref:(i,o)=>{o.chartEl=i,d.value=i}},null,512))}});export{at as default};
