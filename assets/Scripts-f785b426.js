import{d as k,aP as U,e as f,P as $,s as H,R as b,o as y,y as g,z as s,a as m,b as t,j as P,t as T,_ as E,J as F,ab as z,aQ as V,L as x,u as a,N as I,ai as A,aR as B,aD as J,O as S,U as L,T as D,S as O,aF as K,aS as W,aT as Y,ah as C,aU as G,f as j,c as q,F as M,i as Q,ae as X,aV as Z,Y as ee,l as te,h as ae,ao as se,ap as R,w as ne,ar as oe,n as le,aq as de}from"./index-dfdef63a.js";import{N as ce,T as ie}from"./Toolbar-081c4a4c.js";import{N as re}from"./li-ae5b0f33.js";import{N as ue}from"./Scrollbar-69c005e9.js";import"./ToolBar-5c09210c.js";/* empty css                                                                */const pe={class:"buttons"},_e={class:"footer"},fe=k({__name:"Editor",props:{data:{default:()=>({code:"",type:U.Javascript})},config:{default:()=>({height:"600px",tabSize:4,indentWithTab:!0,autofocus:!0,disabled:!1})},mode:{default:"use"}},emits:["update:data","change"],setup(w,{emit:e}){const d=w,p=f(!0),l=$(d.data),r=()=>{e("update:data",l),e("change",l)},c=f(null),i=()=>{const u=c.value.handleRedo;u&&u()},v=()=>{const u=c.value.handleUndo;u&&u()};return H(()=>d.data,()=>{d.data&&(l.code=d.data.code,l.type=d.data.type)}),(u,o)=>{const n=b("x-icon"),_=b("OCodeEditor");return y(),g(_,{ref_key:"cm",ref:c,value:l.code,"onUpdate:value":[o[0]||(o[0]=N=>l.code=N),r]},{"tool-bar":s(()=>[m("div",null,[m("div",pe,[t(n,{class:"item button",name:"back",onClick:v}),t(n,{class:"item button",name:"next",onClick:i})])])]),footer:s(()=>[m("div",_e,[m("div",{class:P(["saved-status",p.value?"save":"unsave"])},T(p.value?"已保存":"未保存"),3)])]),_:1},8,["value"])}}});const ve=E(fe,[["__scopeId","data-v-f4b67509"]]),me={class:"static-data"},ye=k({__name:"Conetent",setup(w){const e=$({id:"",title:"",code:"",type:U.Javascript}),d=f(JSON.stringify({},null,"	")),p=o=>{d.value=o},l=async o=>{e.code=o.code,e.type=o.type};F(z.SRCIPT_KEY,async o=>{await i(o)});const r=f(""),c=()=>{const o=e.code?W(e.type,e.code,["resp","options"]):void 0;if(o&&o.handler)try{r.value=JSON.stringify(o.handler(JSON.parse(d.value),{}),null,"	")}catch(n){r.value=n.message||n}else r.value=JSON.stringify(e.code,null,"	")},i=async o=>{try{const n=await V(o);if(n.status===200){const _=n.data;e.id=_.id,e.id=_.id,e.title=_.name,e.code=_.code,e.type=_.type}}catch(n){x.log(n||n.message)}},v=async()=>{try{const o=await Y({code:e.code,name:e.title||"未命名",type:e.type});if(o.status===201){const n=o.data;e.id=n.id,e.title=n.name,e.code=n.code,e.type=n.type,x.info("数据保存成功")}else C.warning("数据保存失败")}catch{C.warning("数据保存失败")}},u=async()=>{try{(await G(e.id,{code:e.code,name:e.title||"未命名",type:e.type})).status===200?x.info("数据更新成功"):C.warning("数据更新失败")}catch{C.warning("数据更新失败")}};return(o,n)=>{const _=b("x-icon"),N=b("OCodeEditor");return y(),g(a(L),null,{default:s(()=>[m("div",me,[t(a(I),{value:e.title,"onUpdate:value":n[0]||(n[0]=h=>e.title=h),class:"title"},{prefix:s(()=>[t(_,{name:"code"})]),_:1},8,["value"]),t(a(A),null,{default:s(()=>[t(a(B),{class:"save"},{default:s(()=>[t(a(J),{type:"success",onClick:c},{default:s(()=>[S("运行")]),_:1})]),_:1})]),_:1}),t(a(A),null,{default:s(()=>[t(a(B),{class:"save"},{default:s(()=>[t(a(J),{onClick:n[1]||(n[1]=h=>e.id?u():v())},{default:s(()=>[S("保存")]),_:1})]),_:1})]),_:1})]),t(a(L),null,{default:s(()=>[t(a(D),null,{default:s(()=>[t(a(O),{name:"脚本"},{default:s(()=>[t(ve,{data:e,class:"content","onUpdate:data":l},null,8,["data"])]),_:1}),t(a(O),{name:"入参"},{default:s(()=>[t(N,{value:d.value,"onUpdate:value":[n[2]||(n[2]=h=>d.value=h),p]},null,8,["value"])]),_:1})]),_:1}),t(a(K),{"title-placement":"left"},{default:s(()=>[S(" 输出 ")]),_:1}),t(N,{value:r.value,"onUpdate:value":[n[3]||(n[3]=h=>r.value=h),l],class:"content",disable:!0},null,8,["value"])]),_:1})]),_:1})}}});const he=E(ye,[["__scopeId","data-v-d6fc8016"]]),ge={class:"rest-detail"},Se=k({__name:"History",setup(w){const e=f([]),d=async()=>{try{const l=await Z();l.status===200&&(e.value=l.data)}catch(l){x.log(l||l.message)}},p=l=>{ee.emit(z.SRCIPT_KEY,l)};return j(async()=>{await d()}),(l,r)=>(y(),g(a(L),{title:"脚本",size:"small"},{default:s(()=>[t(a(I),{placeholder:"请输入搜索条件"}),t(a(D),null,{default:s(()=>[t(a(O),{name:"脚本列表"},{default:s(()=>[t(a(ce),{"align-text":""},{default:s(()=>[(y(!0),q(M,null,Q(e.value,c=>(y(),g(a(re),{key:c.id,class:"data-item",onClick:i=>p(c.id)},{default:s(()=>[m("div",ge,[m("div",null,[t(a(X),{type:"success",style:{"font-weight":"800"}},{default:s(()=>[S(T(c.type===a(U).Javascript?"JS":"Py"),1)]),_:2},1024),S(" "+T(c.name),1)])])]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}))}});const we=E(Se,[["__scopeId","data-v-8dc1d999"]]),Ne=k({__name:"Scripts",setup(w){const e=f(!1),d=f(0),p=f(0),l=te(()=>({width:d.value+"px",height:p.value+"px"})),r=c=>{const{width:i,height:v}=c.contentRect;d.value=i,p.value=v};return(c,i)=>{const v=ae("resize");return y(),g(a(R),{class:"home"},{default:s(()=>[t(a(se),{class:"header"},{default:s(()=>[t(a(ie))]),_:1}),t(a(R),{"has-sider":"","sider-placement":"right",class:"main"},{default:s(()=>[ne((y(),g(a(oe),{class:"content"},{default:s(()=>[t(a(ue),{"x-scrollable":"",style:le(l.value)},{default:s(()=>[t(he)]),_:1},8,["style"])]),_:1})),[[v,r]]),t(a(de),{class:"right",width:"240",collapsed:e.value,"native-scrollbar":!1,bordered:"","collapsed-width":35,"collapse-mode":"width","show-trigger":"arrow-circle",onCollapse:i[0]||(i[0]=u=>e.value=!0),onExpand:i[1]||(i[1]=u=>e.value=!1)},{default:s(()=>[t(we)]),_:1},8,["collapsed"])]),_:1})]),_:1})}}});const Le=E(Ne,[["__scopeId","data-v-15420552"]]);export{Le as default};
