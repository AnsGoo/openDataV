import{aA as U,bd as q,aB as B,d as V,as as z,at as A,cg as F,e as m,l as N,ch as H,Q as T,aE as M,ci as Q,ax as X,f as G,ah as P,o as k,c as S,b as d,z as r,u as p,aD as R,O as D,U as E,F as J,i as K,y as W,t as Y,a as L,cj as I,ck as Z,L as ee,p as te,m as ae,_ as ne}from"./index-dfdef63a.js";import{a as se,d as ie}from"./pages-49af150a.js";const le=U("ellipsis",{overflow:"hidden"},[q("line-clamp",`
 white-space: nowrap;
 display: inline-block;
 vertical-align: bottom;
 max-width: 100%;
 `),B("line-clamp",`
 display: -webkit-inline-box;
 -webkit-box-orient: vertical;
 `),B("cursor-pointer",`
 cursor: pointer;
 `)]);function $(t){return`${t}-ellipsis--line-clamp`}function j(t,i){return`${t}-ellipsis--cursor-${i}`}const oe=Object.assign(Object.assign({},A.props),{expandTrigger:String,lineClamp:[Number,String],tooltip:{type:[Boolean,Object],default:!0}}),re=V({name:"Ellipsis",inheritAttrs:!1,props:oe,setup(t,{slots:i,attrs:c}){const{mergedClsPrefixRef:l}=z(t),f=A("Ellipsis","-ellipsis",le,F,t,l),h=m(null),_=m(null),w=m(null),g=m(!1),C=N(()=>{const{lineClamp:e}=t,{value:n}=g;return e!==void 0?{textOverflow:"","-webkit-line-clamp":n?"":e}:{textOverflow:n?"":"ellipsis","-webkit-line-clamp":""}});function x(){let e=!1;const{value:n}=g;if(n)return!0;const{value:s}=h;if(s){const{lineClamp:v}=t;if(y(s),v!==void 0)e=s.scrollHeight<=s.offsetHeight;else{const{value:O}=_;O&&(e=O.getBoundingClientRect().width<=s.getBoundingClientRect().width)}o(s,e)}return e}const b=N(()=>t.expandTrigger==="click"?()=>{var e;const{value:n}=g;n&&((e=w.value)===null||e===void 0||e.setShow(!1)),g.value=!n}:void 0);H(()=>{var e;t.tooltip&&((e=w.value)===null||e===void 0||e.setShow(!1))});const a=()=>T("span",Object.assign({},Q(c,{class:[`${l.value}-ellipsis`,t.lineClamp!==void 0?$(l.value):void 0,t.expandTrigger==="click"?j(l.value,"pointer"):void 0],style:C.value}),{ref:"triggerRef",onClick:b.value,onMouseenter:t.expandTrigger==="click"?x:void 0}),t.lineClamp?i:T("span",{ref:"triggerInnerRef"},i));function y(e){if(!e)return;const n=C.value,s=$(l.value);t.lineClamp!==void 0?u(e,s,"add"):u(e,s,"remove");for(const v in n)e.style[v]!==n[v]&&(e.style[v]=n[v])}function o(e,n){const s=j(l.value,"pointer");t.expandTrigger==="click"&&!n?u(e,s,"add"):u(e,s,"remove")}function u(e,n,s){s==="add"?e.classList.contains(n)||e.classList.add(n):e.classList.contains(n)&&e.classList.remove(n)}return{mergedTheme:f,triggerRef:h,triggerInnerRef:_,tooltipRef:w,handleClick:b,renderTrigger:a,getTooltipDisabled:x}},render(){var t;const{tooltip:i,renderTrigger:c,$slots:l}=this;if(i){const{mergedTheme:f}=this;return T(M,Object.assign({ref:"tooltipRef",placement:"top"},i,{getDisabled:this.getTooltipDisabled,theme:f.peers.Tooltip,themeOverrides:f.peerOverrides.Tooltip}),{trigger:c,default:(t=l.tooltip)!==null&&t!==void 0?t:l.default})}else return c()}}),ce=""+new URL("default-5fefac84.png",import.meta.url).href,de=t=>(te("data-v-e197802d"),t=t(),ae(),t),ue={class:"page-list"},pe=["src","onClick"],fe={class:"options"},ge=de(()=>L("span",null,"编辑",-1)),ve=V({__name:"Pages",setup(t){const i=X(),c=m(!1),l=m([]),f=[{key:"preview",label:"预览",icon:h("previewOpen")},{key:"delete",label:"删除",icon:h("delete")}];G(async()=>{await _()});function h(a){return()=>T(I,{name:a})}const _=async()=>{try{const a=await se();a.data&&(l.value=a.data)}catch{P.error("页面数据请求异常")}},w=async(a,y)=>{if(a==="preview")await i.push({name:"PageView",params:{index:y.id}});else if(a==="delete")try{await ie(y.id),await _()}catch(o){ee.log(o?.message||o),P.error("删除失败")}},g=async()=>{if(c.value)return!1;c.value=!0,await i.push({name:"Create"})},C=async a=>{if(c.value)return!1;c.value=!0,await i.push({name:"Editor",params:{index:a.id}})},x=async a=>{await i.push({name:"PageView",params:{index:a.id}})},b=a=>a||ce;return(a,y)=>(k(),S("div",ue,[d(p(E),null,{default:r(()=>[d(p(R),{type:"primary",loading:c.value,onClick:g},{default:r(()=>[D(" 新建 ")]),_:1},8,["loading"])]),_:1}),(k(!0),S(J,null,K(l.value,o=>(k(),S("div",{key:o.id,class:"card"},[(k(),W(p(E),{key:o.id,hoverable:""},{header:r(()=>[d(p(re),{style:{"max-width":"8rem","font-size":"1rem"}},{default:r(()=>[D(Y(o.name),1)]),_:2},1024)]),cover:r(()=>[L("img",{src:b(o.thumbnail),class:"thumbnail-image",alt:"",onClick:u=>x(o)},null,8,pe)]),action:r(()=>[L("div",fe,[d(p(M),{trigger:"hover"},{trigger:r(()=>[d(p(R),{quaternary:"",onClick:u=>C(o)},{icon:r(()=>[d(I,{name:"edit"})]),_:2},1032,["onClick"])]),default:r(()=>[ge]),_:2},1024),d(p(Z),{trigger:"hover",options:f,"show-arrow":!0,onSelect:u=>w(u,o)},{default:r(()=>[d(p(R),{quaternary:""},{icon:r(()=>[d(I,{name:"setting"})]),_:1})]),_:2},1032,["onSelect"])])]),_:2},1024))]))),128))]))}});const _e=ne(ve,[["__scopeId","data-v-e197802d"]]);export{_e as default};
