import{aa as H,ab as q,ac as O,d as V,a1 as F,a2 as M,bh as U,v as m,e as P,bi as z,K as T,ao as A,bj as G,a6 as K,x as X,H as B,o as k,c as S,b as u,w as r,u as d,Z as R,E,G as D,F as Z,f as J,l as Q,C as W,a as L,bk as I,bl as Y,L as ee,bm as ae,bn as te,_ as ne}from"./index-70139cdd.js";import{a as se,d as ie}from"./pages-a508f63c.js";import"./index-c2b5f845.js";const le=H("ellipsis",{overflow:"hidden"},[q("line-clamp",`
 white-space: nowrap;
 display: inline-block;
 vertical-align: bottom;
 max-width: 100%;
 `),O("line-clamp",`
 display: -webkit-inline-box;
 -webkit-box-orient: vertical;
 `),O("cursor-pointer",`
 cursor: pointer;
 `)]);function $(a){return`${a}-ellipsis--line-clamp`}function j(a,i){return`${a}-ellipsis--cursor-${i}`}const oe=Object.assign(Object.assign({},M.props),{expandTrigger:String,lineClamp:[Number,String],tooltip:{type:[Boolean,Object],default:!0}}),re=V({name:"Ellipsis",inheritAttrs:!1,props:oe,setup(a,{slots:i,attrs:c}){const{mergedClsPrefixRef:l}=F(a),f=M("Ellipsis","-ellipsis",le,U,a,l),h=m(null),_=m(null),w=m(null),g=m(!1),y=P(()=>{const{lineClamp:e}=a,{value:n}=g;return e!==void 0?{textOverflow:"","-webkit-line-clamp":n?"":e}:{textOverflow:n?"":"ellipsis","-webkit-line-clamp":""}});function C(){let e=!1;const{value:n}=g;if(n)return!0;const{value:s}=h;if(s){const{lineClamp:v}=a;if(b(s),v!==void 0)e=s.scrollHeight<=s.offsetHeight;else{const{value:N}=_;N&&(e=N.getBoundingClientRect().width<=s.getBoundingClientRect().width)}o(s,e)}return e}const x=P(()=>a.expandTrigger==="click"?()=>{var e;const{value:n}=g;n&&((e=w.value)===null||e===void 0||e.setShow(!1)),g.value=!n}:void 0);z(()=>{var e;a.tooltip&&((e=w.value)===null||e===void 0||e.setShow(!1))});const t=()=>T("span",Object.assign({},G(c,{class:[`${l.value}-ellipsis`,a.lineClamp!==void 0?$(l.value):void 0,a.expandTrigger==="click"?j(l.value,"pointer"):void 0],style:y.value}),{ref:"triggerRef",onClick:x.value,onMouseenter:a.expandTrigger==="click"?C:void 0}),a.lineClamp?i:T("span",{ref:"triggerInnerRef"},i));function b(e){if(!e)return;const n=y.value,s=$(l.value);a.lineClamp!==void 0?p(e,s,"add"):p(e,s,"remove");for(const v in n)e.style[v]!==n[v]&&(e.style[v]=n[v])}function o(e,n){const s=j(l.value,"pointer");a.expandTrigger==="click"&&!n?p(e,s,"add"):p(e,s,"remove")}function p(e,n,s){s==="add"?e.classList.contains(n)||e.classList.add(n):e.classList.contains(n)&&e.classList.remove(n)}return{mergedTheme:f,triggerRef:h,triggerInnerRef:_,tooltipRef:w,handleClick:x,renderTrigger:t,getTooltipDisabled:C}},render(){var a;const{tooltip:i,renderTrigger:c,$slots:l}=this;if(i){const{mergedTheme:f}=this;return T(A,Object.assign({ref:"tooltipRef",placement:"top"},i,{getDisabled:this.getTooltipDisabled,theme:f.peers.Tooltip,themeOverrides:f.peerOverrides.Tooltip}),{trigger:c,default:(a=l.tooltip)!==null&&a!==void 0?a:l.default})}else return c()}}),ce=""+new URL("default-5fefac84.png",import.meta.url).href,de=a=>(ae("data-v-7dc7d8f5"),a=a(),te(),a),ue={class:"page-list"},pe=["src","onClick"],fe={class:"options"},ge=de(()=>L("span",null,"编辑",-1)),ve=V({__name:"Pages",setup(a){const i=K(),c=m(!1),l=m([]),f=[{key:"preview",label:"预览",icon:h("previewOpen")},{key:"delete",label:"删除",icon:h("delete")}];X(async()=>{await _()});function h(t){return()=>T(I,{name:t})}const _=async()=>{try{const t=await se();t.data&&(l.value=t.data)}catch{B.error("页面数据请求异常")}},w=async(t,b)=>{if(t==="preview")await i.push({name:"PageView",params:{index:b.id}});else if(t==="delete")try{await ie(b.id),await _()}catch(o){ee.log(o?.message||o),B.error("删除失败")}},g=async()=>{if(c.value)return!1;c.value=!0,await i.push({name:"Create"})},y=async t=>{if(c.value)return!1;c.value=!0,await i.push({name:"Editor",params:{index:t.id}})},C=async t=>{await i.push({name:"PageView",params:{index:t.id}})},x=t=>t||ce;return(t,b)=>(k(),S("div",ue,[u(d(D),null,{default:r(()=>[u(d(R),{type:"primary",loading:c.value,onClick:g},{default:r(()=>[E(" 新建 ")]),_:1},8,["loading"])]),_:1}),(k(!0),S(Z,null,J(l.value,o=>(k(),S("div",{key:o.id,class:"card"},[(k(),Q(d(D),{key:o.id,hoverable:""},{header:r(()=>[u(d(re),{style:{"max-width":"8rem","font-size":"1rem"}},{default:r(()=>[E(W(o.name),1)]),_:2},1024)]),cover:r(()=>[L("img",{src:x(o.thumbnail),class:"thumbnail-image",alt:"",onClick:p=>C(o)},null,8,pe)]),action:r(()=>[L("div",fe,[u(d(A),{trigger:"hover"},{trigger:r(()=>[u(d(R),{quaternary:"",onClick:p=>y(o)},{icon:r(()=>[u(d(I),{name:"edit"})]),_:2},1032,["onClick"])]),default:r(()=>[ge]),_:2},1024),u(d(Y),{trigger:"hover",options:f,"show-arrow":!0,onSelect:p=>w(p,o)},{default:r(()=>[u(d(R),{quaternary:""},{icon:r(()=>[u(d(I),{name:"setting"})]),_:1})]),_:2},1032,["onSelect"])])]),_:2},1024))]))),128))]))}});const we=ne(ve,[["__scopeId","data-v-7dc7d8f5"]]);export{we as default};
