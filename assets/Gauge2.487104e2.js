import{r as b,h as x}from"./echarts.dba42fd9.js";import{h as N}from"./index.44682809.js";import{u as w,b as C}from"./index.2ad55fca.js";import{t as S}from"./mydark.e6801489.js";import{d as k}from"./lodash-es.5f1bdab1.js";import{d as L,r as c,e as z,w as A,k as y,y as O,a5 as T,u as _,O as E,X as D}from"./@vue.a2815691.js";import"./zrender.0cec7a92.js";import"./tslib.60310f1a.js";import"./axios.744bc20e.js";import"./vue-router.c997c3e8.js";import"./pinia.6e1173f7.js";import"./vue-demi.b3a9cad9.js";import"./mitt.550594b0.js";import"./naive-ui.3474528c.js";import"./date-fns.3c009aaa.js";import"./seemly.50a99b79.js";import"./vueuc.e50d3fb2.js";import"./evtd.9eee5233.js";import"./@css-render.8efa119b.js";import"./vooks.5c35c0ee.js";import"./vdirs.9c42edfb.js";import"./@juggle.37ed2144.js";import"./css-render.d5050412.js";import"./@emotion.6322e2ae.js";import"./treemate.80cdf2c2.js";import"./date-fns-tz.851ed5df.js";import"./async-validator.fb49d0f5.js";import"./dexie.78e6a997.js";import"./lodash.f91bfcd2.js";import"./nprogress.5b68415b.js";import"./@icon-park.b1426ebe.js";const me=L({__name:"Gauge2",props:{componentId:null,propValue:null},setup(m){const e=m;b("mydark",S);const p=w(),u=c(null);let i=null;const l=c(0);z(()=>{h(),V()});const d=o=>{const r=o[0],{width:n,height:g}=r.contentRect;i==null||i.resize({width:n,height:g})},a=()=>{const o={series:[{type:"gauge",min:e.propValue.minValue,max:e.propValue.maxValue,splitNumber:t.value.splitNumber,axisLine:{lineStyle:{width:t.value.axisLine.width,color:t.value.axisLine.color}},pointer:{icon:t.value.pointer.icon,showAbove:!1,length:t.value.pointer.length,width:t.value.pointer.width,offsetCenter:t.value.pointer.offsetCenter,itemStyle:{color:t.value.pointer.color||"inherit"}},axisTick:{length:t.value.axisTick.length,lineStyle:{color:t.value.axisTick.color||"inherit",width:t.value.axisTick.width}},splitLine:{length:t.value.splitLine.length,lineStyle:{color:t.value.splitLine.color||"inherit",width:t.value.splitLine.width}},axisLabel:{show:t.value.axisLabel.show,color:t.value.axisLabel.color||"inherit",fontSize:t.value.axisLabel.fontSize,distance:t.value.axisLabel.distance},title:{offsetCenter:t.value.title.offsetCenter,fontSize:t.value.title.fontSize,color:t.value.title.color},detail:{fontSize:t.value.detail.fontSize,offsetCenter:t.value.detail.offsetCenter,valueAnimation:!0,formatter:function(r){return r+t.value.detail.unit},color:t.value.detail.color||"auto"},data:[{value:l.value,name:e.propValue.title}]}]};return t.value.startAngle!==t.value.endAngle&&(o.series[0].startAngle=t.value.startAngle,o.series[0].endAngle=t.value.endAngle),o},f=o=>{const r=o;e.propValue.datatag===r.TagName&&(l.value=Number(r.TagValue),s())},s=k(()=>{const o=a();o.series[0].data[0].value=l.value,i&&i.setOption({series:o.series})},300),h=()=>{N.post({url:e.propValue.history,data:[e.propValue.datatag]}).then(o=>{o.ErrorCode===200&&(l.value=Number(o.Results[0].TagValue))}).catch(o=>{console.log(o);const r=e.propValue.maxValue;p.isEditMode&&(l.value=Math.round(Math.random()*r))}).finally(()=>{s()})},V=()=>{i=x(u.value,"mydark"),i.clear(),i.setOption(a())};p.isEditMode&&A(()=>e.propValue,()=>{i&&(i.clear(),i.setOption(a()))},{deep:!0});const t=y(()=>({startAngle:Number(e.propValue.startAngle),endAngle:Number(e.propValue.endAngle),minValue:Number(e.propValue.minValue),maxValue:Number(e.propValue.maxValue),splitNumber:Number(e.propValue.splitNumber),axisLine:{width:Number(e.propValue.axisWidth),color:v()},pointer:{width:Number(e.propValue.pointerWidth),color:e.propValue.pointerColor,length:e.propValue.pointerLength,offsetCenter:e.propValue.pointerOffset.split(","),icon:e.propValue.pointStyle},axisLabel:{show:e.propValue.tickShow,color:e.propValue.tickFontColor,fontSize:Number(e.propValue.tickFontSize),distance:Number(e.propValue.tickDistance)},title:{offsetCenter:e.propValue.titleOffset.split(","),fontSize:Number(e.propValue.titleFontSize),color:e.propValue.titleColor},detail:{fontSize:Number(e.propValue.detailFontSize),offsetCenter:e.propValue.detailOffset.split(","),color:e.propValue.detailFontColor,unit:e.propValue.unit},splitLine:{length:Number(e.propValue.splitLength),color:e.propValue.splitColor,width:Number(e.propValue.splitWidth)},axisTick:{length:Number(e.propValue.tickLength),color:e.propValue.tickColor,width:Number(e.propValue.tickWidth)}})),v=()=>e.propValue.axisColor.split(";").map(o=>{const r=o.split(",");return[Number(r[0]),r[1]]});return C("actual",f),O(()=>{i&&(i.clear(),i.dispose())}),(o,r)=>{const n=T("resize");return _((E(),D("div",{ref_key:"chartEl",ref:u},null,512)),[[n,d]])}}});export{me as default};
