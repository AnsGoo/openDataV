import{r as H,h as A}from"./echarts.dba42fd9.js";import{h as x}from"./index.44682809.js";import{u as C}from"./index.2ad55fca.js";import{t as P}from"./mydark.e6801489.js";import{d as w,r as B,e as E,w as z,y as F,a5 as O,u as V,O as b,X as L}from"./@vue.a2815691.js";import"./zrender.0cec7a92.js";import"./tslib.60310f1a.js";import"./axios.744bc20e.js";import"./vue-router.c997c3e8.js";import"./pinia.6e1173f7.js";import"./vue-demi.b3a9cad9.js";import"./mitt.550594b0.js";import"./naive-ui.3474528c.js";import"./date-fns.3c009aaa.js";import"./seemly.50a99b79.js";import"./vueuc.e50d3fb2.js";import"./evtd.9eee5233.js";import"./@css-render.8efa119b.js";import"./vooks.5c35c0ee.js";import"./vdirs.9c42edfb.js";import"./@juggle.37ed2144.js";import"./css-render.d5050412.js";import"./@emotion.6322e2ae.js";import"./treemate.80cdf2c2.js";import"./date-fns-tz.851ed5df.js";import"./async-validator.fb49d0f5.js";import"./lodash-es.5f1bdab1.js";import"./dexie.78e6a997.js";import"./lodash.f91bfcd2.js";import"./nprogress.5b68415b.js";import"./@icon-park.b1426ebe.js";const ft=w({__name:"PercentageChart2",props:{componentId:null,propValue:null},setup(D){const s=D;H("mydark",P);const u=C(),y=B(null);let r=null,o=0,m,f,n=0;E(()=>{v(),clearInterval(m),W(),m=setInterval(M,s.propValue.interval),setTimeout(k,1e3)});function v(){x.get({url:s.propValue.history}).then(e=>{o=e.data||0}).catch(e=>{console.log(e),o=Math.round(Math.random()*100)}).finally(()=>{M()})}const S=e=>{const a=e[0],{width:l,height:i}=a.contentRect;r==null||r.resize({width:l,height:i})},I=(e,a,l,i)=>{let t=e+l*Math.cos(i*Math.PI/180),c=a+l*Math.sin(i*Math.PI/180);return{x:t,y:c}},p=()=>{let e=s.propValue.fontSize,a=s.propValue.lineLength;return{title:{text:"{a|"+o+"%}",x:"center",y:"center",textStyle:{rich:{a:{fontSize:e,color:"#29EEF3"},c:{fontSize:20,color:"#29EEF3"}}}},series:[{name:"ring5",type:"custom",coordinateSystem:"none",renderItem:function(i,t){return{type:"arc",shape:{cx:t.getWidth()/2,cy:t.getHeight()/2,r:Math.min(t.getWidth(),t.getHeight())/2*.6,startAngle:(0+n)*Math.PI/180,endAngle:(90+n)*Math.PI/180},style:{stroke:"#0CD3DB",fill:"transparent",lineWidth:1.5},silent:!0}},data:[0]},{name:"ring5",type:"custom",coordinateSystem:"none",renderItem:function(i,t){return{type:"arc",shape:{cx:t.getWidth()/2,cy:t.getHeight()/2,r:Math.min(t.getWidth(),t.getHeight())/2*.6,startAngle:(180+n)*Math.PI/180,endAngle:(270+n)*Math.PI/180},style:{stroke:"#0CD3DB",fill:"transparent",lineWidth:1.5},silent:!0}},data:[0]},{name:"ring5",type:"custom",coordinateSystem:"none",renderItem:function(i,t){return{type:"arc",shape:{cx:t.getWidth()/2,cy:t.getHeight()/2,r:Math.min(t.getWidth(),t.getHeight())/2*.65,startAngle:(270+-n)*Math.PI/180,endAngle:(40+-n)*Math.PI/180},style:{stroke:"#0CD3DB",fill:"transparent",lineWidth:1.5},silent:!0}},data:[0]},{name:"ring5",type:"custom",coordinateSystem:"none",renderItem:function(i,t){return{type:"arc",shape:{cx:t.getWidth()/2,cy:t.getHeight()/2,r:Math.min(t.getWidth(),t.getHeight())/2*.65,startAngle:(90+-n)*Math.PI/180,endAngle:(220+-n)*Math.PI/180},style:{stroke:"#0CD3DB",fill:"transparent",lineWidth:1.5},silent:!0}},data:[0]},{name:"ring5",type:"custom",coordinateSystem:"none",renderItem:function(i,t){let c=t.getWidth()/2,d=t.getHeight()/2,g=Math.min(t.getWidth(),t.getHeight())/2*.65,h=I(c,d,g,90+-n);return{type:"circle",shape:{cx:h.x,cy:h.y,r:4},style:{stroke:"#0CD3DB",fill:"#0CD3DB"},silent:!0}},data:[0]},{name:"ring5",type:"custom",coordinateSystem:"none",renderItem:function(i,t){let c=t.getWidth()/2,d=t.getHeight()/2,g=Math.min(t.getWidth(),t.getHeight())/2*.65,h=I(c,d,g,270+-n);return{type:"circle",shape:{cx:h.x,cy:h.y,r:4},style:{stroke:"#0CD3DB",fill:"#0CD3DB"},silent:!0}},data:[0]},{name:"invent",type:"pie",radius:["58%","45%"],silent:!0,clockwise:!0,startAngle:90,z:0,zlevel:0,label:{position:"center"},data:[{value:o,name:"",itemStyle:{color:{colorStops:[{offset:0,color:"#4FADFD"},{offset:1,color:"#28E8FA"}]}}},{value:100-o,name:"",label:{show:!1},itemStyle:{color:"#173164"}}]},{name:"",type:"gauge",radius:"58%",center:["50%","50%"],startAngle:0,endAngle:359.9,splitNumber:8,emphasis:{scale:!0},axisTick:{show:!1},splitLine:{length:a,lineStyle:{width:5,color:"#061740"}},axisLabel:{show:!1},pointer:{show:!1},axisLine:{lineStyle:{opacity:0}},detail:{show:!1},data:[{value:0,name:""}]}]}},M=()=>{x.get({url:s.propValue.history}).then(e=>{o=e.data||0}).catch(e=>{u.isEditMode&&(o=Math.round(Math.random()*100))}).finally(()=>{let e=o.toFixed(2).split(".")[0],a=o.toFixed(2).split(".")[1];const l="{a|"+e+"}{a|."+a+"%}";r&&r.setOption({title:{text:l}})})},W=()=>{r=A(y.value,"mydark"),r.clear(),r.setOption(p())};u.isEditMode&&z(()=>s.propValue,(e,a)=>{console.log(e),r&&(r.clear(),r.setOption(p()))},{deep:!0});const _=()=>{const e=p();r&&(n=n+3,r.setOption(e,!0))},k=()=>{f=setInterval(_,100)};return F(()=>{clearInterval(m),clearInterval(f),r&&(r.clear(),r.dispose())}),(e,a)=>{const l=O("resize");return V((b(),L("div",{ref_key:"chartEl",ref:y},null,512)),[[l,S]])}}});export{ft as default};
