var bt=Object.defineProperty;var _t=(t,e,i)=>e in t?bt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var G=(t,e,i)=>(_t(t,typeof e!="symbol"?e+"":e,i),i);var d=(t,e,i)=>new Promise((r,A)=>{var m=y=>{try{U(i.next(y))}catch(h){A(h)}},n=y=>{try{U(i.throw(y))}catch(h){A(h)}},U=y=>y.done?r(y.value):Promise.resolve(y.value).then(m,n);U((i=i.apply(t,e)).next())});import{a_ as Y,d as Z,h as P,r as O,q as tt,a8 as at,o as T,c as ot,b as F,v as s,z as c,V as W,t as lt,u as o,a$ as it,F as dt,f as Ft,aQ as j,b0 as X,b1 as mt,_ as et,a7 as ft,y as x,b2 as M,a2 as R,i as ut,a as ct,b3 as Q,B as K,n as gt,Q as w,O as rt,b4 as kt,b5 as Tt,a4 as yt,b6 as Pt,b7 as Ut,aR as Ot,b8 as Bt,b9 as xt}from"./index.6ecd5136.js";import{j as Nt,e as ht,a as nt,N as L}from"./Editor.b6a1e392.js";import{S as Ct}from"./enums.27e2d34b.js";import{u as Dt}from"./useEventBus.8f871294.js";import{j as pt,a as H,b as q,p as Lt,g as Vt,c as It,u as $t,d as Mt,v as Wt}from"./View.98c81636.js";import{v as Xt}from"./view.5c1a451a.js";const zt=t=>d(void 0,null,function*(){return Y.get({url:`/dataset/rest/${t}/`})}),Jt=()=>d(void 0,null,function*(){return Y.get({url:"/dataset/rest/"})}),jt=(t,e)=>d(void 0,null,function*(){return Y.put({url:`/dataset/rest/${t}/`,data:e})}),Kt=t=>d(void 0,null,function*(){return Y.post({url:"/dataset/rest/",data:t})}),Ca=t=>d(void 0,null,function*(){return Y.delete({url:`/dataset/rest/${t}/`})}),Gt={class:"header"},Qt=Z({__name:"DynamicKVForm",props:{value:{default:()=>[{key:"",value:"",disable:!1,id:P(),options:[]}]},title:{default:""},options:null},emits:["update:value"],setup(t,{emit:e}){const i=t,r=O(i.value),A=(a,C,_)=>{r.value[a][C]=_,e("update:value",r.value)},m=()=>{const a=r.value.length;r.value.splice(a,0,{key:"",value:"",disable:!1,id:P()}),e("update:value",r.value)},n=a=>{r.value.splice(a,1),r.value.length===0&&r.value.push({key:"",value:"",disable:!1,id:P()}),e("update:value",r.value)},U=()=>{r.value=[{key:"",value:"",disable:!1,id:P()}],e("update:value",r.value)},y=()=>{e("update:value",r.value)},h=a=>{r.value[a].disable=!r.value[a].disable,e("update:value",r.value)},B=a=>!a.startsWith(" ")&&!a.endsWith(" ");return tt(()=>i.value,()=>{i.value&&(r.value=i.value)}),(a,C)=>{const _=at("x-icon");return T(),ot(dt,null,[F("div",Gt,[s(o(it),{"title-placement":"left",style:{width:"50%"}},{default:c(()=>[W(lt(t.title),1)]),_:1}),s(o(it),{"title-placement":"right",style:{width:"50%"}},{default:c(()=>[s(_,{name:"add",color:"#18A058",class:"action",onClick:C[0]||(C[0]=S=>m())}),s(_,{name:"clear",color:"#F76560",class:"action",onClick:C[1]||(C[1]=S=>U())}),s(_,{name:"edit",color:"#2080F0",class:"action",onClick:C[2]||(C[2]=S=>y())})]),_:1})]),(T(!0),ot(dt,null,Ft(r.value,(S,k)=>(T(),ot("div",{key:S.id},[s(o(mt),{class:"param-item"},{default:c(()=>[s(o(j),{style:{width:"50%"},size:"small","input-props":{autocomplete:"disabled"},value:r.value[k].key,"allow-input":B,placeholder:`\u53C2\u6570${k+1}`,"onUpdate:value":l=>A(k,"key",l)},null,8,["value","placeholder","onUpdate:value"]),s(o(j),{style:{width:"50%"},size:"small",value:r.value[k].value,"allow-input":B,placeholder:`\u503C${k+1}`,"onUpdate:value":l=>A(k,"value",l)},null,8,["value","placeholder","onUpdate:value"]),s(o(X),{size:"small",onClick:l=>h(k)},{icon:c(()=>[s(_,{name:S.disable?"close":"check",color:S.disable?"#333639":"#2080F0"},null,8,["name","color"])]),_:2},1032,["onClick"]),s(o(X),{size:"small",onClick:l=>n(k)},{icon:c(()=>[s(_,{name:"delete",color:"#F76560"})]),_:2},1032,["onClick"])]),_:2},1024)]))),128))],64)}}});const st=et(Qt,[["__scopeId","data-v-86e5f944"]]);var At=(t=>(t.Accept="Accept",t.AcceptCH="Accept-CH",t.AcceptCHLifetime="Accept-CH-Lifetime",t.AcceptCharset="Accept-Charset",t.AcceptEncoding="Accept-Encoding",t.AcceptLanguage="Accept-Language",t.AcceptPatch="Accept-Patch",t.AcceptPost="Accept-Post",t.AcceptRanges="Accept-Ranges",t.AccessControlAllowCredentials="Access-Control-Allow-Credentials",t.AccessControlAllowHeaders="Access-Control-Allow-Headers",t.AccessControlAllowMethods="Access-Control-Allow-Methods",t.AccessControlAllowOrigin="Access-Control-Allow-Origin",t.AccessControlExposeHeaders="Access-Control-Expose-Headers",t.AccessControlMaxAge="Access-Control-Max-Age",t.AccessControlRequestHeaders="Access-Control-Request-Headers",t.AccessControlRequestMethod="Access-Control-Request-Method",t.Age="Age",t.Allow="Allow",t.AltSvc="Alt-Svc",t.Authorization="Authorization",t.CacheControl="Cache-Control",t.ClearSiteData="Clear-Site-Data",t.Connection="Connection",t.ContentDisposition="Content-Disposition",t.ContentDPR="Content-DPR",t.ContentEncoding="Content-Encoding",t.ContentLanguage="Content-Language",t.ContentLength="Content-Length",t.ContentLocation="Content-Location",t.ContentRange="Content-Range",t.ContentSecurityPolicy="Content-Security-Policy",t.ContentSecurityPolicyReportOnly="Content-Security-Policy-Report-Only",t.ContentType="Content-Type",t.Cookie="Cookie",t.CrossOriginEmbedderPolicy="Cross-Origin-Embedder-Policy",t.CrossOriginOpenerPolicy="Cross-Origin-Opener-Policy",t.CrossOriginResourcePolicy="Cross-Origin-Resource-Policy",t.Date="Date",t.DeviceMemory="Device-Memory",t.Digest="Digest",t.Deprecated="Deprecated",t.DNT="DNT",t.Downlink="Downlink",t.NonstandardDeprecated="Non-standardDeprecated",t.DPR="DPR",t.EarlyData="Early-Data",t.Experimental="Experimental",t.ECT="ECT",t.ETag="ETag",t.Expect="Expect",t.ExpectCT="Expect-CT",t.Expires="Expires",t.FeaturePolicy="Feature-Policy",t.Forwarded="Forwarded",t.From="From",t.Host="Host",t.IfMatch="If-Match",t.IfModifiedSince="If-Modified-Since",t.IfNoneMatch="If-None-Match",t.IfRange="If-Range",t.IfUnmodifiedSince="If-Unmodified-Since",t.KeepAlive="Keep-Alive",t.LargeAllocation="Large-Allocation",t.LastModified="Last-Modified",t.Link="Link",t.Location="Location",t.MaxForwards="Max-Forwards",t.NEL="NEL",t.Origin="Origin",t.Pragma="Pragma",t.ProxyAuthenticate="Proxy-Authenticate",t.ProxyAuthorization="Proxy-Authorization",t.Range="Range",t.Referer="Referer",t.ReferrerPolicy="Referrer-Policy",t.RetryAfter="Retry-After",t.RTT="RTT",t.SaveData="Save-Data",t.SecCHUA="Sec-CH-UA",t.SecCHUAArch="Sec-CH-UA-Arch",t.SecCHUABitness="Sec-CH-UA-Bitness",t.SecCHUAFullVersion="Sec-CH-UA-Full-Version",t.SecCHUAFullVersionList="Sec-CH-UA-Full-Version-List",t.SecCHUAMobile="Sec-CH-UA-Mobile",t.SecCHUAModel="Sec-CH-UA-Model",t.SecCHUAPlatform="Sec-CH-UA-Platform",t.SecCHUAPlatformVersion="Sec-CH-UA-Platform-Version",t.SecFetchDest="Sec-Fetch-Dest",t.SecFetchMode="Sec-Fetch-Mode",t.SecFetchSite="Sec-Fetch-Site",t.SecFetchUser="Sec-Fetch-User",t.SecGPC="Sec-GPC",t.SecWebSocketAccept="Sec-WebSocket-Accept",t.Server="Server",t.ServerTiming="Server-Timing",t.ServiceWorkerNavigationPreload="Service-Worker-Navigation-Preload",t.SetCookie="Set-Cookie",t.SourceMap="SourceMap",t.StrictTransportSecurity="Strict-Transport-Security",t.TE="TE",t.TimingAllowOrigin="Timing-Allow-Origin",t.Tk="Tk",t.Trailer="Trailer",t.TransferEncoding="Transfer-Encoding",t.Upgrade="Upgrade",t.UpgradeInsecureRequests="Upgrade-Insecure-Requests",t.UserAgent="User-Agent",t.Vary="Vary",t.Via="Via",t.ViewportWidth="Viewport-Width",t.WantDigest="Want-Digest",t.Warning="Warning",t.Width="Width",t.WWWAuthenticate="WWW-Authenticate",t.XContentTypeOptions="X-Content-Type-Options",t.Nontandard="Non-standard",t.XDNSPrefetchControl="X-DNS-Prefetch-Control",t.XForwardedFor="X-Forwarded-For",t.XForwardedHost="X-Forwarded-Host",t.XForwardedProto="X-Forwarded-Proto",t.XFrameOptions="X-Frame-Options",t.XXSSProtection="X-XSS-Protection",t))(At||{}),E=(t=>(t.GET="GET",t.POST="POST",t.PUT="PUT",t.DELETE="DELETE",t.PATCH="PATCH",t.HEAD="HEAD",t.OPTIONS="OPTIONS",t.TRACE="TRACE",t.CONNECT="CONNECT",t))(E||{});const vt=Z({__name:"ReponseContentView",props:{data:null},setup(t){const e=t,i=ft(),r=O({height:"600px",tabSize:4,indentWithTab:!0,autofocus:!0,disabled:!0}),A=O(e.data);return tt(()=>e.data,()=>{A.value=e.data}),(m,n)=>(T(),x(o(ht),{language:o(Nt),config:r.value,theme:o(i).darkTheme?"dark":"light",code:A.value},null,8,["language","config","theme","code"]))}}),Yt={class:"script"},Zt={class:"buttons"},Et={class:"footer"},Rt=Z({__name:"Editor",props:{data:{default:()=>({code:"",type:M.Javascript})},config:{default:()=>({height:"600px",tabSize:4,indentWithTab:!0,autofocus:!0,disabled:!1})},mode:{default:"use"}},emits:["update:data","change"],setup(t,{emit:e}){const i=t,r=O([]),A=O(!0),m=O(!1),n=ft(),U={Javascript:pt,Python:Lt},y=R({}),h=R(i.data),B=()=>{A.value=!1},a=ut(()=>Object.keys(M).map(f=>({label:f,value:f}))),C=O(M.Javascript),_=ut(()=>U[C.value]||pt),S=O(null),k=()=>{const f=S.value.handleRedo;f&&f()},l=()=>{const f=S.value.handleUndo;f&&f()},v=()=>{e("change",h),e("update:data",h),A.value=!0,w.success("\u4FDD\u5B58\u6210\u529F")},I=()=>d(this,null,function*(){try{const f=yield Vt();f.status===200&&(r.value=f.data.map(b=>({value:b.id,label:b.name})))}catch(f){console.log(f||f.message)}});tt(()=>i.data,()=>{i.data&&(h.code=i.data.code,h.type=i.data.type)});const u=f=>d(this,null,function*(){f?yield $(f):p()}),p=()=>{y.id=void 0,y.title=void 0,h.code="",h.type=M.Javascript},g=()=>d(this,null,function*(){try{const f=yield It({name:y.title||"\u672A\u547D\u540D",code:i.data.code,type:i.data.type});if(f.status===201){const b=f.data;y.id=b.id,y.title=b.name,w.success("\u811A\u672C\u4FDD\u5B58\u6210\u529F")}else w.warning("\u811A\u672C\u4FDD\u5B58\u5931\u8D25")}catch(f){w.warning("\u811A\u672C\u4FDD\u5B58\u5931\u8D25")}}),D=()=>d(this,null,function*(){try{(yield $t(y.id,{name:y.title||"\u672A\u547D\u540D",code:i.data.code,type:i.data.type})).status===200?w.success("\u811A\u672C\u66F4\u65B0\u6210\u529F"):w.warning("\u811A\u672C\u66F4\u65B0\u5931\u8D25")}catch(f){w.warning("\u811A\u672C\u66F4\u65B0\u5931\u8D25")}}),$=f=>d(this,null,function*(){try{const b=yield Mt(f);if(b.status===200){const N=b.data;y.id=N.id,y.title=N.name,h.code=N.code,h.type=N.type,e("change",h),e("update:data",h)}}catch(b){return}});return ct(()=>d(this,null,function*(){yield I()})),(f,b)=>{const N=at("x-icon");return T(),x(o(ht),{ref_key:"cm",ref:S,code:h.code,"onUpdate:code":[b[3]||(b[3]=z=>h.code=z),B],language:o(_),config:t.config,theme:o(n).darkTheme?"dark":"light"},{"tool-bar":c(()=>[F("div",null,[F("div",Yt,[s(o(Q),{options:r.value,value:y.id,class:"selected",clearable:"","onUpdate:value":u,onClear:p},null,8,["options","value"]),t.mode==="debug"?(T(),x(o(j),{key:0,value:y.title,"onUpdate:value":b[0]||(b[0]=z=>y.title=z),class:"title"},{prefix:c(()=>[s(N,{name:"code"})]),_:1},8,["value"])):K("",!0),t.mode==="debug"?(T(),x(o(H),{key:1},{default:c(()=>[s(o(q),{class:"save"},{default:c(()=>[s(o(X),{disabled:y.id===void 0,onClick:D},{default:c(()=>[W("\u66F4\u65B0")]),_:1},8,["disabled"]),s(o(X),{type:"success",onClick:g},{default:c(()=>[W("\u53E6\u5B58\u4E3A")]),_:1})]),_:1})]),_:1})):K("",!0)]),F("div",Zt,[s(N,{class:"item button",name:"save",onClick:v}),s(N,{class:"item button",name:"back",onClick:l}),s(N,{class:"item button",name:"next",onClick:k})])])]),footer:c(()=>[F("div",Et,[F("div",{class:gt(["saved-status",A.value?"save":"unsave"])},lt(A.value?"\u5DF2\u4FDD\u5B58":"\u672A\u4FDD\u5B58"),3),F("div",{class:"lang",onClick:b[2]||(b[2]=z=>m.value=!0)},[s(o(Q),{value:h.type,"onUpdate:value":[b[1]||(b[1]=z=>h.type=z),B],options:o(a),class:"item language",size:"tiny",style:{width:"110px"}},null,8,["value","options"])])])]),_:1},8,["code","language","config","theme"])}}});const St=et(Rt,[["__scopeId","data-v-69a0700b"]]),V=t=>{const e={};for(const i of t)i.key&&!i.disable&&(e[i.key]=i.value);return e},J=t=>Object.keys(t).map(e=>({key:e,value:t[e],disable:!1,id:P()})),Ht=t=>{const e=rt(t);return{headers:V(t.headers),params:V(t.params),data:V(t.data),method:e.method,url:e.url,afterScript:e.afterScript}},Da=t=>{const e=rt(t);return{headers:J(e.headers),params:J(e.params),data:J(e.data),method:t.method,url:t.url,afterScript:t.afterScript}};class qt extends kt{constructor(){super("data");G(this,"data");this.version(2).stores({data:"++id, type, data"})}}class ta{constructor(e,i){G(this,"db");G(this,"key");G(this,"snapshotMax",10);this.key=e,this.db=new qt}save(e){return d(this,null,function*(){var r,A,m;yield this.db.data.add({type:this.key,data:rt(e)});const i=yield(r=this.db)==null?void 0:r.data.where("type").equals(this.key).count();if(i&&i>this.snapshotMax){const n=yield(A=this.db)==null?void 0:A.data.orderBy("id").first();yield(m=this.db)==null?void 0:m.data.delete(n.id)}})}list(){return d(this,null,function*(){var e;return(e=this.db)==null?void 0:e.data.where("type").equals(this.key).reverse().toArray()})}clear(){return d(this,null,function*(){var e;yield(e=this.db)==null?void 0:e.data.where("type").equals(this.key).delete()})}}function wt(t,e){return new ta(t,e)}const aa={class:"rest-data"},ea={class:"api"},oa={class:"config"},sa={class:"params"},ia={class:"headers"},na={class:"headers"},la={class:"response"},ca=Z({__name:"Rest",props:{restOptions:{default:()=>({method:E.GET,url:"/getRiskArea",headers:[{key:"",value:"",disable:!1,id:P()}],params:[{key:"",value:"",disable:!1,id:P()}],data:[{key:"",value:"",disable:!1,id:P()}],afterScript:{code:"",type:M.Javascript}})},mode:{default:"use"}},emits:["update:restOptions","change"],setup(t,{emit:e}){const i=t,r=()=>[{key:"",value:"",disable:!1,id:P()}],A=O([]),m=()=>d(this,null,function*(){try{const u=yield Jt();u.status===200&&(A.value=u.data.map(p=>({label:p.name,value:p.id})))}catch(u){console.log(u||u.message)}}),n=Object.keys(E).map(u=>({label:u,value:u})),U=Object.keys(At),y=()=>{a.id=void 0,a.title=void 0,a.headers=[{key:"",value:"",disable:!1,id:P()}],a.data=[{key:"",value:"",disable:!1,id:P()}],a.params=[{key:"",value:"",disable:!1,id:P()}],a.method=E.GET,a.url="",a.afterScript={code:"",type:M.Javascript}};let h;i.mode==="debug"&&(Dt(Ct.REST_KEY,u=>d(this,null,function*(){yield B(u),yield _()})),h=wt("REST",!0));const B=u=>d(this,null,function*(){try{const p=yield zt(u);if(p.status===200){const g=p.data;a.method=g.method,a.url=g.url;const D=J(g.data||{});a.data=D.length>0?D:r();const $=J(g.params||{});a.params=$.length>0?$:r(),a.title=g.name,a.id=g.id;const f=J(g.headers||{});a.headers=f.length>0?f:r()}}catch(p){return}}),a=R(i.restOptions),C=O({code:0,data:"",afterData:"",headers:{}}),_=()=>d(this,null,function*(){var p;const u=Tt(Ht(a),!0);try{const g=yield u.request();C.value.code=g.status,C.value.data=JSON.stringify(g.data,null,"	"),C.value.afterData=JSON.stringify(g.afterData,null,"	"),C.value.headers=g.headers,a.id&&h&&h.save(a)}catch(g){const D=g.response||(g.toJSON?g.toJSON():{});C.value.code=D.status,C.value.data=g.stack||g.message,C.value.afterData=g.stack||g.message,C.value.headers=D.headers||((p=D==null?void 0:D.config)==null?void 0:p.headers)||{}}}),S=()=>{e("change",a),e("update:restOptions",a)},k=u=>{a.afterScript=u,S()},l=u=>d(this,null,function*(){yield B(u),yield _(),e("update:restOptions",a)}),v=()=>d(this,null,function*(){try{const u=V(a.headers),p=V(a.headers),g=V(a.data),D=yield Kt({data:g,name:a.title||"\u672A\u547D\u540D",url:a.url,method:a.method,headers:u,params:p});if(D.status===201){const $=D.data;a.id=$.id,a.title=$.name,w.success("\u6570\u636E\u4FDD\u5B58\u6210\u529F")}else w.warning("\u6570\u636E\u4FDD\u5B58\u5931\u8D25")}catch(u){w.warning("\u6570\u636E\u4FDD\u5B58\u5931\u8D25")}}),I=()=>d(this,null,function*(){try{const u=V(a.headers),p=V(a.headers),g=V(a.data);(yield jt(a.id,{data:g,name:a.title||"\u672A\u547D\u540D",url:a.url,method:a.method,headers:u,params:p})).status===200?w.success("\u6570\u636E\u66F4\u65B0\u6210\u529F"):w.warning("\u6570\u636E\u66F4\u65B0\u5931\u8D25")}catch(u){w.warning("\u6570\u636E\u66F4\u65B0\u5931\u8D25")}});return ct(()=>d(this,null,function*(){yield _(),yield m()})),(u,p)=>{const g=at("x-icon");return T(),x(o(yt),null,{default:c(()=>[F("div",aa,[s(o(Q),{options:A.value,value:a.id,class:"selected",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u6570\u636E","onUpdate:value":l,onClear:y},null,8,["options","value"]),t.mode==="debug"?(T(),x(o(j),{key:0,value:a.title,"onUpdate:value":p[0]||(p[0]=D=>a.title=D),class:"title"},{prefix:c(()=>[s(g,{name:"api"})]),_:1},8,["value"])):K("",!0),t.mode==="debug"?(T(),x(o(H),{key:1},{default:c(()=>[s(o(q),{class:"save"},{default:c(()=>[s(o(X),{onClick:p[1]||(p[1]=D=>a.id?I():v())},{default:c(()=>[W("\u4FDD\u5B58")]),_:1})]),_:1})]),_:1})):K("",!0)]),F("div",ea,[s(o(Q),{value:a.method,"onUpdate:value":p[2]||(p[2]=D=>a.method=D),options:o(n),class:"method","show-arrow":!0,onUpdateValue:S},null,8,["value","options"]),s(o(j),{value:a.url,"onUpdate:value":p[3]||(p[3]=D=>a.url=D),class:"url",onUpdateValue:S},null,8,["value"]),s(o(H),null,{default:c(()=>[s(o(q),{class:"send"},{default:c(()=>[s(o(X),{type:"primary",onClick:_},{default:c(()=>[W("\u8C03\u8BD5")]),_:1})]),_:1})]),_:1})]),F("div",oa,[s(o(nt),{type:"line",animated:""},{default:c(()=>[s(o(L),{name:"query",tab:"\u8BF7\u6C42\u53C2\u6570","display-directive":"show"},{default:c(()=>[F("div",sa,[s(st,{value:a.params,"onUpdate:value":[p[4]||(p[4]=D=>a.params=D),S],title:"\u8BF7\u6C42\u53C2\u6570"},null,8,["value"])])]),_:1}),s(o(L),{name:"data",tab:"\u8BF7\u6C42\u4F53","display-directive":"show"},{default:c(()=>[F("div",ia,[s(st,{value:a.data,"onUpdate:value":[p[5]||(p[5]=D=>a.data=D),S],title:"\u8BF7\u6C42\u4F53"},null,8,["value"])])]),_:1}),s(o(L),{name:"headers",tab:"\u8BF7\u6C42\u5934","display-directive":"show"},{default:c(()=>[F("div",na,[s(st,{value:a.headers,"onUpdate:value":[p[6]||(p[6]=D=>a.headers=D),S],title:"\u8BF7\u6C42\u5934",options:o(U)},null,8,["value","options"])])]),_:1})]),_:1})]),F("div",la,[s(o(it),{"title-placement":"left"},{default:c(()=>[W(" \u8BF7\u6C42\u54CD\u5E94 "),F("span",{class:gt(["resp-code",C.value.code>=400?"resp-fail":"resp-success"])},lt(C.value.code?C.value.code:""),3)]),_:1}),s(o(nt),null,{default:c(()=>[s(o(L),{name:"data",tab:"\u811A\u672C\u5904\u7406\u7ED3\u679C","display-directive":"show"},{default:c(()=>[s(vt,{data:C.value.afterData,class:"content"},null,8,["data"])]),_:1}),s(o(L),{name:"origin",tab:"\u539F\u59CB\u8BF7\u6C42\u7ED3\u679C","display-directive":"show"},{default:c(()=>[s(vt,{data:C.value.data,class:"content"},null,8,["data"])]),_:1}),s(o(L),{name:"scripts",tab:"\u811A\u672C","display-directive":"show"},{default:c(()=>[s(o(St),{data:a.afterScript,mode:t.mode,class:"content","onUpdate:data":k},null,8,["data","mode"])]),_:1})]),_:1})])]),_:1})}}});const Aa=et(ca,[["__scopeId","data-v-d4820c47"]]),ra={class:"static-data"},da=Z({__name:"View",props:{options:{default:()=>({dataId:"",title:"",script:{code:"",type:M.Javascript}})},mode:{default:"use"}},emits:["dataChange","scriptChange"],setup(t,{emit:e}){const i=t,r=O([]);let A;i.mode==="debug"&&(Dt(Ct.STATIC_KEY,l=>d(this,null,function*(){yield h(l)})),A=wt("STATIC",!0));const m=()=>d(this,null,function*(){try{const l=yield Ot();l.status===200&&(r.value=l.data.map(v=>({label:v.name,value:v.id})))}catch(l){console.log(l||l.message)}}),n=R({id:i.options.dataId,title:i.options.title||"",afterData:"",originData:""}),U=()=>{n.id=void 0},y=l=>{n.originData=l,a(i.options.script)},h=l=>d(this,null,function*(){if(l){const v=yield C(l);v&&(n.originData=v.data,a(i.options.script),n.id=l,n.title=v.name,A&&A.save({id:l,name:v.name}))}else n.originData="",n.afterData="";e("dataChange",n.id,n.title)}),B=l=>d(this,null,function*(){a(l),e("scriptChange",l)}),a=l=>{const v=l&&l.code?Pt(l.type,l.code,["resp","options"],!1):void 0;if(v&&v.handler)try{n.afterData=JSON.stringify(v.handler(n.originData,{}),null,"	")}catch(I){n.afterData=I.message||I}else n.afterData=JSON.stringify(n.originData,null,"	")},C=l=>d(this,null,function*(){try{const v=yield Ut(l);if(v.status===200)return v.data}catch(v){return}}),_=()=>d(this,null,function*(){try{const l=yield Bt({data:n.originData,name:n.title||"\u672A\u547D\u540D"});if(l.status===201){const v=l.data;n.id=v.id,n.title=v.name,n.originData=v.data,w.success("\u6570\u636E\u4FDD\u5B58\u6210\u529F"),yield m()}else w.warning("\u6570\u636E\u4FDD\u5B58\u5931\u8D25")}catch(l){w.warning("\u6570\u636E\u4FDD\u5B58\u5931\u8D25")}}),S=()=>d(this,null,function*(){try{(yield xt(n.id,{data:n.originData,name:n.title||"\u672A\u547D\u540D"})).status===200?(w.success("\u6570\u636E\u66F4\u65B0\u6210\u529F"),yield m()):w.warning("\u6570\u636E\u66F4\u65B0\u5931\u8D25")}catch(l){w.warning("\u6570\u636E\u66F4\u65B0\u5931\u8D25")}});ct(()=>d(this,null,function*(){yield m(),yield k()}));const k=()=>d(this,null,function*(){if(i.options&&i.options.dataId){const l=yield C(i.options.dataId);l&&(n.id=l.id,n.title=l.name,n.originData=l.data,a(i.options.script),e("dataChange",i.options.dataId,l.name))}else n.id="",n.title="",n.originData="",n.afterData=""});return tt(()=>i.options,()=>d(this,null,function*(){yield k()}),{deep:!0}),(l,v)=>{const I=at("x-icon");return T(),x(o(yt),null,{default:c(()=>[F("div",ra,[s(o(Q),{options:r.value,value:n.id,class:"selected",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u6570\u636E","onUpdate:value":h,onClear:U},null,8,["options","value"]),t.mode==="debug"?(T(),x(o(j),{key:0,value:n.title,"onUpdate:value":v[0]||(v[0]=u=>n.title=u),class:"title"},{prefix:c(()=>[s(I,{name:"data"})]),_:1},8,["value"])):K("",!0),t.mode==="debug"?(T(),x(o(H),{key:1},{default:c(()=>[s(o(q),{class:"save"},{default:c(()=>[s(o(X),{type:"primary",onClick:v[1]||(v[1]=u=>n.id?S():_())},{default:c(()=>[W("\u4FDD\u5B58")]),_:1})]),_:1})]),_:1})):K("",!0)]),s(o(nt),null,{default:c(()=>[s(o(L),{name:"data",tab:"\u5904\u7406\u6570\u636E","display-directive":"show"},{default:c(()=>[s(o(Wt),{content:n.afterData,"onUpdate:content":v[2]||(v[2]=u=>n.afterData=u),class:"content",disable:!0},null,8,["content"])]),_:1}),s(o(L),{name:"origin",tab:"\u539F\u59CB\u6570\u636E","display-directive":"show"},{default:c(()=>[s(o(Xt),{content:n.originData,title:n.title,class:"content",mode:t.mode,"onUpdate:content":y},null,8,["content","title","mode"])]),_:1}),s(o(L),{name:"scripts",tab:"\u811A\u672C","display-directive":"show"},{default:c(()=>[s(o(St),{data:t.options.script,class:"content",mode:t.mode,"onUpdate:data":B},null,8,["data","mode"])]),_:1})]),_:1})]),_:1})}}});const Sa=et(da,[["__scopeId","data-v-7e657f0d"]]);export{Aa as R,Sa as V,E as a,Ca as d,Jt as g,Ht as r,Da as s,wt as u};
