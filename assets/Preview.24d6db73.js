var D=Object.defineProperty,W=Object.defineProperties;var x=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var j=(a,s,e)=>s in a?D(a,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[s]=e,S=(a,s)=>{for(var e in s||(s={}))B.call(s,e)&&j(a,e,s[e]);if(b)for(var e of b(s))z.call(s,e)&&j(a,e,s[e]);return a},h=(a,s)=>W(a,x(s));var _=(a,s,e)=>new Promise((u,d)=>{var n=o=>{try{c(e.next(o))}catch(t){d(t)}},m=o=>{try{c(e.throw(o))}catch(t){d(t)}},c=o=>o.done?u(o.value):Promise.resolve(o.value).then(n,m);c((e=e.apply(a,s)).next())});import{C as F}from"./ComponentWrapper.46ad7033.js";import{_ as C,q as L,u as N,f as O,e as g,B as q,p as A}from"./index.ef2789db.js";import{f as I,d as w,r as P,q as R,o as T,N as v,W as y,F as H,Z as J,O as M,u as k,Q}from"./@vue.f8650cf9.js";import"./vue-router.32a64423.js";import"./pinia.30c42674.js";import"./vue-demi.b3a9cad9.js";import"./mitt.550594b0.js";import"./naive-ui.2edb364b.js";import"./date-fns.3ef01b04.js";import"./seemly.5d1c4af6.js";import"./vueuc.ebfd6ddc.js";import"./evtd.79485e8d.js";import"./@css-render.7ab96087.js";import"./vooks.ee7b0837.js";import"./vdirs.8ff5d312.js";import"./@juggle.37ed2144.js";import"./css-render.d5050412.js";import"./@emotion.6322e2ae.js";import"./treemate.80cdf2c2.js";import"./async-validator.fb49d0f5.js";import"./lodash-es.5f1bdab1.js";import"./dexie.78e6a997.js";import"./nprogress.5f640c6a.js";import"./@icon-park.f4b03c54.js";const U=I({setup(a){const s=L(),e=N(),u=[],d=w(()=>e.componentData),n=P({width:0,height:0,scale:0,dataWs:"",image:"/images/bg.jpg"}),m=w(()=>{const t=h(S({},n.value),{backgroundImage:n.value.image,backgroundSize:"cover"});return O(t,["width","height","backgroundImage","backgroundSize"])});R(()=>_(this,null,function*(){const t=yield s.undo();t&&e.setLayoutData({canvasData:t.canvasData,canvasStyle:t.canvasStyle}),n.value=e.canvasStyleData,n.value.dataWs&&u.push(c("actual",n.value.dataWs)),o(),window.addEventListener("resize",o)}));const c=(t,p)=>{const r=new WebSocket(p);return r.onopen=()=>{console.log("websocket\u8FDE\u63A5\u6210\u529F")},r.onclose=()=>{console.log("websocket\u8FDE\u63A5\u88AB\u5173\u95ED")},r.onmessage=l=>{const i=JSON.parse(l.data);g.emit(t,i),q.forEach((E,f)=>{E.isRegExp?new RegExp(t).test(i.TagName)&&g.emit(f,i):f===i.TagName&&g.emit(f,i)})},r};T(()=>{window.removeEventListener("resize",o),u.forEach(t=>{console.log("\u5173\u95EDwebsocket"),t.close()})});const o=()=>{const t=document.querySelector(".screen");if(t){const p=n.value.width,r=n.value.height;A(t,p,r)}};return(t,p)=>(v(),y("div",{class:"bg",style:Q(k(m))},[(v(!0),y(H,null,J(k(d),(r,l)=>(v(),M(F,{key:l,component:r},null,8,["component"]))),128))],4))}});var Se=C(U,[["__scopeId","data-v-c2cd97e0"]]);export{Se as default};
