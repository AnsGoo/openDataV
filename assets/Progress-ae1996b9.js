import{d as a,r as e,af as t,p as r,aa as l,D as o,aA as u,a7 as s,a8 as d,o as i,v,f as n,F as p,E as c,az as h,y as b,ab as f}from"./index-40170f2c.js";import{s as m}from"./index.esm-01328638.js";import{h as x}from"./index-63f72026.js";const g={class:"dv-percent-pond"},y=["id"],W=["offset","stop-color"],k=["id","x2"],$=["offset","stop-color"],G=["x","y","rx","ry","stroke-width","stroke","width","height"],N=["stroke-width","stroke-dasharray","stroke","points"],w=["stroke","fill","x","y"],z=f(a({__name:"Progress",props:{component:{}},setup(a){const f=a,{propValue:z}=m(f.component),R=e(150),S=e(150),V=e(60),j=e(`percent-pond-gradientId1-${t()}`),C=e(`percent-pond-gradientId2-${t()}`),D=a=>{const e=a.contentRect;R.value=e.width,S.value=e.height};r((async()=>{await _()}));const _=async()=>{if(z.data.history)try{const a=await x.post({url:z.data.history,data:[z.data.datatag]});200===a.status&&(V.value=100*(Number(a.data.TagValue)||0)/Number(z.data.maxValue))}catch(a){l.log(a.message||a)}},I=o((()=>({colors:[z.attr.color1,z.attr.color2],borderWidth:Number(z.attr.borderWidth),borderGap:Number(z.attr.borderGap),lineDash:z.attr.lineDash,gapWeight:z.attr.gapWeight,textColor:z.attr.textColor,fontSize:Number(z.attr.fontSize),borderRadius:Number(z.attr.borderRadius),localGradient:Boolean(z.attr.localGradient),formatter:z.attr.formatter}))),T=o((()=>I.value.borderWidth?R.value-I.value.borderWidth:0)),F=o((()=>I.value.borderWidth?S.value-I.value.borderWidth:0)),A=o((()=>I.value?S.value-2*(I.value.borderWidth+I.value.borderGap):0)),B=o((()=>I.value&&I.value.localGradient?j.value:C.value)),E=o((()=>{const a=S.value/2;if(!I.value)return`0, ${a} 0, ${a}`;const e=(R.value-2*(I.value.borderWidth+I.value.borderGap))/100*V.value;return`\n        ${I.value.borderWidth+I.value.borderGap}, ${a}\n        ${I.value.borderWidth+I.value.borderGap+e}, ${a+.001}`})),P=o((()=>{if(!I.value.colors)return[];const a=100/(I.value.colors.length-1);return I.value.colors.map(((e,t)=>[a*t,e]))})),q=o((()=>I.value?"200%":"100%")),H=o((()=>I.value.formatter?I.value.formatter.replace("{value}",V.value.toString()):"")),J=o((()=>({fontSize:(z.attr.fontSize||12)+"px"})));return u("actual",(a=>{const e=a;z.data.datatag&&e.TagName===z.data.datatag&&(V.value=Number((100*Number(e.TagValue)/Number(z.data.maxValue)).toFixed(2)))})),(a,e)=>{const t=s("resize");return d((i(),v("div",g,[(i(),v("svg",null,[n("defs",null,[n("linearGradient",{id:j.value,x1:"0%",y1:"0%",x2:"100%",y2:"0%"},[(i(!0),v(p,null,c(P.value,((a,e)=>(i(),v("stop",{key:e,offset:`${a[0]}%`,"stop-color":a[1]},null,8,W)))),128))],8,y),n("linearGradient",{id:C.value,x1:"0%",y1:"0%",x2:q.value,y2:"0%"},[(i(!0),v(p,null,c(P.value,((a,e)=>(i(),v("stop",{key:e,offset:`${a[0]}%`,"stop-color":a[1]},null,8,$)))),128))],8,k)]),n("rect",{x:I.value?I.value.borderWidth/2:"0",y:I.value?I.value.borderWidth/2:"0",rx:I.value?I.value.borderRadius:"0",ry:I.value?I.value.borderRadius:"0",fill:"transparent","stroke-width":I.value?I.value.borderWidth:"0",stroke:`url(#${j.value})`,width:T.value>0?T.value:0,height:F.value>0?F.value:0},null,8,G),n("polyline",{"stroke-width":A.value,"stroke-dasharray":I.value?[I.value.lineDash,I.value.gapWeight].join(","):"0",stroke:`url(#${B.value})`,points:E.value},null,8,N),n("text",{style:b(J.value),stroke:I.value?I.value.textColor:"#fff",fill:I.value?I.value.textColor:"#fff",x:R.value/2,y:S.value/2},h(H.value),13,w)]))])),[[t,D]])}}}),[["__scopeId","data-v-5d8ba23b"]]);export{z as default};
