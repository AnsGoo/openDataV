var x=(y,t,l)=>new Promise((u,s)=>{var v=i=>{try{_(l.next(i))}catch(g){s(g)}},f=i=>{try{_(l.throw(i))}catch(g){s(g)}},_=i=>i.done?u(i.value):Promise.resolve(i.value).then(v,f);_((l=l.apply(y,t)).next())});import{h as F}from"./index.a867692c.js";import{_ as E,e as N,b as $}from"./index.395efaf1.js";import{d as H,r as b,e as T,k as a,u as L,O as c,X as m,Y as h,F as w,_ as z,G as r,Z as O,R as X,a5 as j}from"./@vue.a2815691.js";import"./axios.744bc20e.js";import"./vue-router.c997c3e8.js";import"./pinia.6e1173f7.js";import"./vue-demi.b3a9cad9.js";import"./mitt.550594b0.js";import"./naive-ui.6ffd8c7f.js";import"./date-fns.3c009aaa.js";import"./seemly.50a99b79.js";import"./vueuc.e50d3fb2.js";import"./evtd.9eee5233.js";import"./@css-render.8efa119b.js";import"./vooks.5c35c0ee.js";import"./vdirs.9c42edfb.js";import"./@juggle.37ed2144.js";import"./css-render.d5050412.js";import"./@emotion.6322e2ae.js";import"./treemate.80cdf2c2.js";import"./date-fns-tz.851ed5df.js";import"./async-validator.fb49d0f5.js";import"./lodash-es.5f1bdab1.js";import"./dexie.78e6a997.js";import"./nprogress.5b68415b.js";import"./@icon-park.b1426ebe.js";const M={class:"dv-percent-pond"},Y=["id"],Z=["offset","stop-color"],q=["id","x2"],A=["offset","stop-color"],J=["x","y","rx","ry","stroke-width","stroke","width","height"],K=["stroke-width","stroke-dasharray","stroke","points"],Q=["stroke","fill","x","y"],U=H({__name:"Progress",props:{componentId:null,propValue:null},setup(y){const t=y,l=b(150),u=b(150),s=b(60),v=b(`percent-pond-gradientId1-${N()}`),f=b(`percent-pond-gradientId2-${N()}`),_=o=>{const d=o[0].contentRect;l.value=d.width,u.value=d.height},i=o=>{const n=o;t.propValue.datatag&&n.TagName===t.propValue.datatag&&(s.value=Number((Number(n.TagValue)*100/Number(t.propValue.maxValue)).toFixed(2)))};T(()=>x(this,null,function*(){yield g()}));const g=()=>x(this,null,function*(){if(t.propValue.history)try{const o=yield F.post({url:t.propValue.history,data:[t.propValue.datatag]});o.ErrorCode===200&&(s.value=(Number(o.Results[0].TagValue)||0)*100/Number(t.propValue.maxValue))}catch(o){console.log(o.message||o)}}),e=a(()=>({colors:[t.propValue.color1,t.propValue.color1],borderWidth:Number(t.propValue.borderWidth),borderGap:Number(t.propValue.borderGap),lineDash:t.propValue.lineDash,gapWeight:t.propValue.gapWeight,textColor:t.propValue.textColor,fontSize:Number(t.propValue.fontSize),borderRadius:Number(t.propValue.borderRadius),localGradient:Boolean(t.propValue.localGradient),formatter:t.propValue.formatter})),k=a(()=>e.value.borderWidth?l.value-e.value.borderWidth:0),W=a(()=>e.value.borderWidth?u.value-e.value.borderWidth:0),S=a(()=>e.value?u.value-(e.value.borderWidth+e.value.borderGap)*2:0),C=a(()=>e.value&&e.value.localGradient?v.value:f.value),D=a(()=>{const o=u.value/2;if(!e.value)return`0, ${o} 0, ${o}`;const n=(l.value-(e.value.borderWidth+e.value.borderGap)*2)/100*s.value;return`
        ${e.value.borderWidth+e.value.borderGap}, ${o}
        ${e.value.borderWidth+e.value.borderGap+n}, ${o+.001}`}),G=a(()=>{if(!e.value.colors)return[];const o=e.value.colors.length,n=100/(o-1);return e.value.colors.map((d,p)=>[n*p,d])}),I=a(()=>e.value?"200%":"100%"),R=a(()=>e.value.formatter?e.value.formatter.replace("{value}",s.value.toString()):""),B=a(()=>({fontSize:(t.propValue.fontSize||12)+"px"})),P=o=>{o.key==="maxValue"&&(s.value=Number((Number(o.value)*100/Number(t.propValue.maxValue)).toFixed(2)))};return $(t.componentId,P),$("actual",i),(o,n)=>{const d=j("resize");return L((c(),m("div",M,[(c(),m("svg",null,[h("defs",null,[h("linearGradient",{id:v.value,x1:"0%",y1:"0%",x2:"100%",y2:"0%"},[(c(!0),m(w,null,z(r(G),(p,V)=>(c(),m("stop",{key:V,offset:`${p[0]}%`,"stop-color":p[1]},null,8,Z))),128))],8,Y),h("linearGradient",{id:f.value,x1:"0%",y1:"0%",x2:r(I),y2:"0%"},[(c(!0),m(w,null,z(r(G),(p,V)=>(c(),m("stop",{key:V,offset:`${p[0]}%`,"stop-color":p[1]},null,8,A))),128))],8,q)]),h("rect",{x:r(e)?r(e).borderWidth/2:"0",y:r(e)?r(e).borderWidth/2:"0",rx:r(e)?r(e).borderRadius:"0",ry:r(e)?r(e).borderRadius:"0",fill:"transparent","stroke-width":r(e)?r(e).borderWidth:"0",stroke:`url(#${v.value})`,width:r(k)>0?r(k):0,height:r(W)>0?r(W):0},null,8,J),h("polyline",{"stroke-width":r(S),"stroke-dasharray":r(e)?[r(e).lineDash,r(e).gapWeight].join(","):"0",stroke:`url(#${r(C)})`,points:r(D)},null,8,K),h("text",{style:X(r(B)),stroke:r(e)?r(e).textColor:"#fff",fill:r(e)?r(e).textColor:"#fff",x:l.value/2,y:u.value/2},O(r(R)),13,Q)]))])),[[d,_]])}}});var $e=E(U,[["__scopeId","data-v-98ad59aa"]]);export{$e as default};
