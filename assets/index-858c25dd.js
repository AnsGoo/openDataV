import{bi as $,d as g,v as C,x as S,H as U,o as O,l as A,w as y,a as _,b as r,g as H,C as J,_ as q,R as E,c as I,u as v,aQ as L,O as R,ab as N,D as x,aP as w,aL as V,bj as j,F as k,b6 as F,bk as m,I as B,bl as P,bm as z,bn as G,bo as Q,bp as W,ay as D,bq as X,br as K,aO as Y,e as Z}from"./index-10d63009.js";function ee(u,a,s,o){switch(u){case"Javascript":return te(a,s)}}function te(u,a,s){try{return{handler:new Function(...a,u)}}catch(o){return{error:o}}}class ae{type="Custom";key;afterCallback;constructor(a){this.key=a,this.buildAfterCallback()}buildAfterCallback(){const a=ee("Javascript",this.key,["data","options"]);a&&a.handler&&(this.afterCallback=(s,o)=>a.handler(s,o))}toJSON(){return{key:this.key,type:this.type}}}const M=ae,se=new $("script"),ne={class:"buttons"},oe={class:"footer"},le=g({__name:"ScriptsEditor",props:{code:{default:""},mode:{default:"use"}},emits:["update:code","change"],setup(u,{emit:a}){const s=u,o=C(!0),e=l=>{a("update:code",l),o.value=!1},n=C(null),i=()=>{a("change",s.code),a("update:code",s.code),o.value=!0,se.success("图层已经到底了")};return S(async()=>{}),(l,d)=>{const f=U("x-icon"),b=U("OCodeEditor");return O(),A(b,{ref_key:"cm",ref:n,value:l.code,"onUpdate:value":e,onChange:e},{"tool-bar":y(()=>[_("div",null,[_("div",ne,[r(f,{class:"item button",name:"save",onClick:i})])])]),footer:y(()=>[_("div",oe,[_("div",{class:H(["saved-status",o.value?"save":"unsave"])},J(o.value?"已保存":"未保存"),3)])]),_:1},8,["value"])}}});const re=q(le,[["__scopeId","data-v-43064d30"]]),ue=g({__name:"View",props:{slotter:{}},setup(u){const a=u,s=C(!1),o=C(void 0),e=async()=>{if(a.slotter.scriptConfig&&a.slotter.scriptConfig.type==="Custom"){const l=a.slotter.scriptConfig;o.value=l.key}else o.value=""},n=l=>{o.value=l,i()},i=()=>{if(o.value&&a.slotter){const l=new M(o.value);a.slotter.afterCallbackChange(l)}};return S(async()=>{await e()}),E(()=>a.slotter,l=>{l&&e()}),(l,d)=>(O(),I(k,null,[r(v(w),{key:"data",label:"自定义脚本"},{default:y(()=>[r(v(L),null,{default:y(()=>[r(v(R),{value:o.value},null,8,["value"]),r(v(N),{type:"primary",onClick:d[0]||(d[0]=f=>s.value=!0)},{default:y(()=>[x(" 编辑 ")]),_:1})]),_:1})]),_:1}),r(v(j),{show:s.value,"onUpdate:show":d[3]||(d[3]=f=>s.value=f)},{default:y(()=>[r(v(V),{style:{width:"600px"},title:"自定义脚本",bordered:!1,size:"small",role:"dialog",closable:"","aria-modal":"true",onClose:d[2]||(d[2]=f=>s.value=!1)},{default:y(()=>[r(re,{code:o.value,"onUpdate:code":d[1]||(d[1]=f=>o.value=f),onChange:n},null,8,["code"])]),_:1})]),_:1},8,["show"])],64))}}),be={type:"Custom",name:"自定义脚本",component:F(ue),handler:M},pe={key:"filterValue",name:"过滤数据",extendParams:[{label:"过滤key",prop:"key",type:m.TEXT,props:{defaultValue:"value",placeholder:"请输入过滤key值"}},{label:"上限",prop:"topLimit",type:m.NUMBER,props:{defaultValue:void 0,placeholder:"过滤的最大值"}},{label:"下限",prop:"lowLimit",type:m.NUMBER,props:{defaultValue:void 0,placeholder:"过滤的最小值"}}],func:(u,a={key:"value",topLimit:1/0,lowLimit:-1/0})=>{const{key:s,topLimit:o,lowLimit:e}=a;return u.filter(n=>n[s]>e&&n[s]<o)}},h={filterValue:pe};class ce{type="System";key;extendParams;afterCallback;constructor(a,s={}){this.key=a,this.extendParams=s,this.buildAfterCallback()}buildAfterCallback(){const a=h[this.key];a&&(this.afterCallback=(s,o)=>a.func(s,this.extendParams))}getFuncs(){return h}toJSON(){return{key:this.key,extendParams:this.extendParams,type:"System"}}}const T=ce,ie=g({props:{args:{type:Object,default:()=>{}},component:{type:Object,default:()=>{}},value:{type:Object}},emits:["updateValue"],setup(u,{emit:a}){const s=o=>{a("updateValue",o)};return()=>[B(u.component,{args:u.args,value:u.value,onUpdateValue:s})]}});function de(u){return typeof u=="function"||Object.prototype.toString.call(u)==="[object Object]"&&!Y(u)}const fe=g({components:{OSwitch:P},props:{items:{type:Array,required:!0},data:{type:Object,required:!0}},emits:["change","update:data"],setup(u,{emit:a}){const s=(e,n)=>{a("change",n,e)},o=(e,n)=>{let i;if(!n)return r(k,null,[x(" ")]);const l=e.props||{},d=l?.options||[];function f(b,c){return b in l?l[b]:c}switch(e.type){case m.COLOR:return r(K,{value:n[e.prop],"onUpdate:value":t=>n[e.prop]=t,swatches:X,modes:["hex","rgb","hsl"],onUpdateValue:t=>s(t,e.prop)},null);case m.SELECT:return r(D,{value:n[e.prop],"onUpdate:value":t=>n[e.prop]=t,placeholder:e.label,onUpdateValue:t=>s(t,e.prop),options:d,clearable:!0},null);case m.RADIO:return r(W,{value:n[e.prop],"onUpdate:value":t=>n[e.prop]=t,name:e.prop,onUpdateValue:t=>s(t,e.prop)},de(i=d.map(t=>r(Q,{value:t.value,key:t.value},{default:()=>[t.label]})))?i:{default:()=>[i]});case m.NUMBER:const b=f("max",9999999999),c=f("min",-9999999999),p=f("precision",void 0);return r(G,{value:n[e.prop],"onUpdate:value":t=>n[e.prop]=t,onUpdateValue:t=>s(t,e.prop),max:b,min:c,precision:p,clearable:!0},{prefix:l.prefix,suffix:l.suffix});case m.SWITCH:return B(P,{value:n[e.prop],onUpdateValue:t=>{n[e.prop]=t,s(t,e.prop)}});case m.CUSTOM:return r(ie,{value:n[e.prop],"onUpdate:value":t=>n[e.prop]=t,onUpdateValue:t=>s(t,e.prop),component:l.componentType,args:l.args},null);default:return r(R,{clearable:!0,value:n[e.prop],"onUpdate:value":t=>n[e.prop]=t,onUpdateValue:t=>s(t,e.prop),readonly:l.editable===!1,disabled:l.disabled},{prefix:l.prefix,suffix:l.suffix})}};return()=>r(k,null,[u.items.map(e=>r(w,{key:`${e.prop}`,label:e.label},{default:()=>[z(u.data)?r(k,null,null):o(e,u.data)]}))])}}),ve=g({__name:"View",props:{slotter:{}},setup(u){const a=u,s=C(!1),o=Z(()=>Object.keys(h).map(p=>{const t=h[p];return{label:t.name,value:t.key}})),e=C([]),n=C({}),i=C(null),l=(c,p)=>{f()},d=c=>{i.value=c,e.value=h[c]?.extendParams||[];const p={};e.value.forEach(t=>{p[t.prop]=t.props?.defaultValue}),n.value=p,f()};S(async()=>{await b()});const f=()=>{if(i.value&&a.slotter){const c=new T(i.value,n.value);a.slotter.afterCallbackChange(c)}},b=async()=>{if(a.slotter.scriptConfig&&a.slotter.scriptConfig.type==="System"){const c=a.slotter.scriptConfig,p=c.key;i.value=p,e.value=h[p]?.extendParams||[],n.value=c.extendParams||{}}else i.value=null,e.value=[],n.value={}};return E(()=>a.slotter,c=>{c&&b()}),(c,p)=>(O(),I(k,null,[r(v(w),{key:"data",label:"系统脚本"},{default:y(()=>[r(v(L),null,{default:y(()=>[r(v(D),{value:i.value,"onUpdate:value":[p[0]||(p[0]=t=>i.value=t),d],options:o.value},null,8,["value","options"]),r(v(N),{type:"primary",onClick:p[1]||(p[1]=t=>s.value=!0)},{default:y(()=>[x(" 文档 ")]),_:1})]),_:1})]),_:1}),r(v(fe),{data:n.value,"onUpdate:data":p[2]||(p[2]=t=>n.value=t),items:e.value,onChange:l},null,8,["data","items"]),r(v(j),{show:s.value,"onUpdate:show":p[4]||(p[4]=t=>s.value=t)},{default:y(()=>[r(v(V),{style:{width:"600px"},title:"文档",bordered:!1,size:"small",role:"dialog",closable:"","aria-modal":"true",onClose:p[3]||(p[3]=t=>s.value=!1)},{default:y(()=>[x("我还没有写文档")]),_:1})]),_:1},8,["show"])],64))}}),me={type:"System",name:"系统脚本",component:F(ve),funcs:h,handler:T};export{be as C,me as S,ee as m};
