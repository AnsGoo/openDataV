import{S as e,aG as a,T as i,d as t,aU as n,X as s,aV as l,r,D as o,aW as c,t as d,aX as u,aY as p,Q as g,p as v,aZ as m,o as f,v as h,a as w,w as b,u as y,aE as k,g as x,e as C,F as T,E as _,c as O,az as R,f as j,j as S,a_ as E,aa as L,ag as $,ah as D,ab as B}from"./index-40170f2c.js";import{a as I,d as P}from"./pages-55261304.js";import"./index-63f72026.js";const V=e("ellipsis",{overflow:"hidden"},[a("line-clamp","\n white-space: nowrap;\n display: inline-block;\n vertical-align: bottom;\n max-width: 100%;\n "),i("line-clamp","\n display: -webkit-inline-box;\n -webkit-box-orient: vertical;\n "),i("cursor-pointer","\n cursor: pointer;\n ")]);function q(e){return`${e}-ellipsis--line-clamp`}function z(e,a){return`${e}-ellipsis--cursor-${a}`}const H=t({name:"Ellipsis",inheritAttrs:!1,props:Object.assign(Object.assign({},s.props),{expandTrigger:String,lineClamp:[Number,String],tooltip:{type:[Boolean,Object],default:!0}}),setup(e,{slots:a,attrs:i}){const t=n(),u=s("Ellipsis","-ellipsis",V,l,e,t),g=r(null),v=r(null),m=r(null),f=r(!1),h=o((()=>{const{lineClamp:a}=e,{value:i}=f;return void 0!==a?{textOverflow:"","-webkit-line-clamp":i?"":a}:{textOverflow:i?"":"ellipsis","-webkit-line-clamp":""}}));function w(){let a=!1;const{value:i}=f;if(i)return!0;const{value:n}=g;if(n){const{lineClamp:i}=e;if(function(a){if(!a)return;const i=h.value,n=q(t.value);void 0!==e.lineClamp?y(a,n,"add"):y(a,n,"remove");for(const e in i)a.style[e]!==i[e]&&(a.style[e]=i[e])}(n),void 0!==i)a=n.scrollHeight<=n.offsetHeight;else{const{value:e}=v;e&&(a=e.getBoundingClientRect().width<=n.getBoundingClientRect().width)}!function(a,i){const n=z(t.value,"pointer");"click"!==e.expandTrigger||i?y(a,n,"remove"):y(a,n,"add")}(n,a)}return a}const b=o((()=>"click"===e.expandTrigger?()=>{var e;const{value:a}=f;a&&(null===(e=m.value)||void 0===e||e.setShow(!1)),f.value=!a}:void 0));c((()=>{var a;e.tooltip&&(null===(a=m.value)||void 0===a||a.setShow(!1))}));function y(e,a,i){"add"===i?e.classList.contains(a)||e.classList.add(a):e.classList.contains(a)&&e.classList.remove(a)}return{mergedTheme:u,triggerRef:g,triggerInnerRef:v,tooltipRef:m,handleClick:b,renderTrigger:()=>d("span",Object.assign({},p(i,{class:[`${t.value}-ellipsis`,void 0!==e.lineClamp?q(t.value):void 0,"click"===e.expandTrigger?z(t.value,"pointer"):void 0],style:h.value}),{ref:"triggerRef",onClick:b.value,onMouseenter:"click"===e.expandTrigger?w:void 0}),e.lineClamp?a:d("span",{ref:"triggerInnerRef"},a)),getTooltipDisabled:w}},render(){var e;const{tooltip:a,renderTrigger:i,$slots:t}=this;if(a){const{mergedTheme:n}=this;return d(u,Object.assign({ref:"tooltipRef",placement:"top"},a,{getDisabled:this.getTooltipDisabled,theme:n.peers.Tooltip,themeOverrides:n.peerOverrides.Tooltip}),{trigger:i,default:null!==(e=t.tooltip)&&void 0!==e?e:t.default})}return i()}}),U=""+new URL("default-5fefac84.png",import.meta.url).href,X={class:"page-list"},A=["src","onClick"],F={class:"options"},G=(e=>($("data-v-1f6b0c1b"),e=e(),D(),e))((()=>j("span",null,"编辑",-1))),M=B(t({__name:"Pages",setup(e){const a=g(),i=r(!1),t=r([]),n=[{key:"preview",label:"预览",icon:s("previewOpen")},{key:"delete",label:"删除",icon:s("delete")}];function s(e){return()=>d(S,{name:e})}v((async()=>{await l()}));const l=async()=>{try{const e=await I();e.data&&(t.value=e.data)}catch(e){m.error("页面数据请求异常")}},o=async()=>{if(i.value)return!1;i.value=!0,await a.push({name:"Create"})};return(e,s)=>(f(),h("div",X,[w(y(C),null,{default:b((()=>[w(y(k),{type:"primary",loading:i.value,onClick:o},{default:b((()=>[x(" 新建 ")])),_:1},8,["loading"])])),_:1}),(f(!0),h(T,null,_(t.value,(e=>(f(),h("div",{key:e.id,class:"card"},[(f(),O(y(C),{key:e.id,hoverable:""},{header:b((()=>[w(y(H),{style:{"max-width":"8rem","font-size":"1rem"}},{default:b((()=>[x(R(e.name),1)])),_:2},1024)])),cover:b((()=>{return[j("img",{src:(i=e.thumbnail,i||U),class:"thumbnail-image",alt:"",onClick:i=>(async e=>{await a.push({name:"PageView",params:{index:e.id}})})(e)},null,8,A)];var i})),action:b((()=>[j("div",F,[w(y(u),{trigger:"hover"},{trigger:b((()=>[w(y(k),{quaternary:"",onClick:t=>(async e=>{if(i.value)return!1;i.value=!0,await a.push({name:"Editor",params:{index:e.id}})})(e)},{icon:b((()=>[w(y(S),{name:"edit"})])),_:2},1032,["onClick"])])),default:b((()=>[G])),_:2},1024),w(y(E),{trigger:"hover",options:n,"show-arrow":!0,onSelect:i=>(async(e,i)=>{if("preview"===e)await a.push({name:"PageView",params:{index:i.id}});else if("delete"===e)try{await P(i.id),await l()}catch(t){L.log(t?.message||t),m.error("删除失败")}})(i,e)},{default:b((()=>[w(y(k),{quaternary:""},{icon:b((()=>[w(y(S),{name:"setting"})])),_:1})])),_:2},1032,["onSelect"])])])),_:2},1024))])))),128))]))}}),[["__scopeId","data-v-1f6b0c1b"]]);export{M as default};
