var D=Object.defineProperty,W=Object.defineProperties;var x=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var h=(s,a,e)=>a in s?D(s,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[a]=e,S=(s,a)=>{for(var e in a||(a={}))z.call(a,e)&&h(s,e,a[e]);if(b)for(var e of b(a))B.call(a,e)&&h(s,e,a[e]);return s},_=(s,a)=>W(s,x(a));var j=(s,a,e)=>new Promise((u,p)=>{var n=o=>{try{c(e.next(o))}catch(t){p(t)}},m=o=>{try{c(e.throw(o))}catch(t){p(t)}},c=o=>o.done?u(o.value):Promise.resolve(o.value).then(n,m);c((e=e.apply(s,a)).next())});import{C as F}from"./ComponentWrapper.944994bf.js";import{_ as C,v as I,u as L,e as v,H as A,p as N,f as O}from"./index.2fc0df38.js";import{p as q,c as w,r as H,q as M,o as P,x as f,y,F as R,a6 as T,M as J,u as k,I as U}from"./@vue.7df1a0ef.js";import"./@vueuse.fe63d129.js";import"./vue-router.e129948e.js";import"./pinia.685e9614.js";import"./vue-demi.b3a9cad9.js";import"./mitt.550594b0.js";import"./element-plus.54ccd689.js";import"./lodash.8679a684.js";import"./nprogress.5f640c6a.js";import"./async-validator.5d25c98b.js";import"./@popperjs.a8a4a6a0.js";import"./resize-observer-polyfill.8deb1e21.js";import"./lodash-es.4775bb8f.js";import"./dexie.c25c286a.js";import"./@icon-park.87123711.js";const G=q({setup(s){const a=I(),e=L(),u=[],p=w(()=>e.componentData),n=H({width:0,height:0,scale:0,dataWs:"",image:"/images/bg.jpg"}),m=w(()=>{const t=_(S({},n.value),{backgroundImage:n.value.image,backgroundSize:"cover"});return O(t,["width","height","backgroundImage","backgroundSize"])});M(()=>j(this,null,function*(){const t=yield a.undo();t&&e.setLayoutData({canvasData:t.canvasData,canvasStyle:t.canvasStyle}),n.value=e.canvasStyleData,n.value.dataWs&&u.push(c("actual",n.value.dataWs)),o(),window.addEventListener("resize",o)}));const c=(t,l)=>{const r=new WebSocket(l);return r.onopen=()=>{console.log("websocket\u8FDE\u63A5\u6210\u529F")},r.onclose=()=>{console.log("websocket\u8FDE\u63A5\u88AB\u5173\u95ED")},r.onmessage=d=>{const i=JSON.parse(d.data);v.emit(t,i),A.forEach((E,g)=>{E.isRegExp?new RegExp(t).test(i.TagName)&&v.emit(g,i):g===i.TagName&&v.emit(g,i)})},r};P(()=>{window.removeEventListener("resize",o),u.forEach(t=>{console.log("\u5173\u95EDwebsocket"),t.close()})});const o=()=>{const t=document.querySelector(".screen");if(t){const l=n.value.width,r=n.value.height;N(t,l,r)}};return(t,l)=>(f(),y("div",{class:"bg",style:U(k(m))},[(f(!0),y(R,null,T(k(p),(r,d)=>(f(),J(F,{key:d,component:r},null,8,["component"]))),128))],4))}});var me=C(G,[["__scopeId","data-v-c2cd97e0"]]);export{me as default};
