var Z=(e,t,l)=>new Promise((c,u)=>{var f=i=>{try{w(l.next(i))}catch(M){u(M)}},d=i=>{try{w(l.throw(i))}catch(M){u(M)}},w=i=>i.done?c(i.value):Promise.resolve(i.value).then(f,d);w((l=l.apply(e,t)).next())});import{c as de,S as X,C as J,a as ie,i as he,b as ce,d as fe,e as ge,f as pe,g as me,h as ye,j as V,G as K,k as we,R as Q,Z as ee,l as Pe,p as Se,m as te,B as be,n as ae,o as Ie,u as Me}from"./hooks.b8c00718.js";import{u as Ce}from"./useProp.afe31ed3.js";import{d as Le,r as Te,a as De,w as Ee,u as xe,o as _e,c as ke,f as Ae}from"./index.efbb82d5.js";import"./theme.31b3b9c9.js";function Re(e,t){return t=t||{},de(e,null,null,t.state!=="normal")}function We(e){var t=X.extend(e);return X.registerClass(t),t}function ze(e){var t=J.extend(e);return J.registerClass(t),t}ie([he,ce]);ie(fe);We({type:"series.liquidFill",optionUpdated:function(){var e=this.option;e.gridSize=Math.max(Math.floor(e.gridSize),4)},getInitialData:function(e,t){var l=ge(e.data,{coordDimensions:["value"]}),c=new pe(l,this);return c.initData(e.data),c},defaultOption:{color:["#294D99","#156ACF","#1598ED","#45BDFF"],center:["50%","50%"],radius:"50%",amplitude:"8%",waveLength:"80%",phase:"auto",period:"auto",direction:"right",shape:"circle",waveAnimation:!0,animationEasing:"linear",animationEasingUpdate:"linear",animationDuration:2e3,animationDurationUpdate:1e3,outline:{show:!0,borderDistance:8,itemStyle:{color:"none",borderColor:"#294D99",borderWidth:8,shadowBlur:20,shadowColor:"rgba(0, 0, 0, 0.25)"}},backgroundStyle:{color:"#E3F7FF"},itemStyle:{opacity:.95,shadowBlur:50,shadowColor:"rgba(0, 0, 0, 0.4)"},label:{show:!0,color:"#294D99",insideColor:"#fff",fontSize:50,fontWeight:"bold",align:"center",baseline:"middle",position:"inside"},emphasis:{itemStyle:{opacity:.8}}}});const Be=me({type:"ec-liquid-fill",shape:{waveLength:0,radius:0,radiusY:0,cx:0,cy:0,waterLevel:0,amplitude:0,phase:0,inverse:!1},buildPath:function(e,t){t.radiusY==null&&(t.radiusY=t.radius);for(var l=Math.max(Math.ceil(2*t.radius/t.waveLength*4)*2,8);t.phase<-Math.PI*2;)t.phase+=Math.PI*2;for(;t.phase>0;)t.phase-=Math.PI*2;var c=t.phase/Math.PI/2*t.waveLength,u=t.cx-t.radius+c-t.radius*2;e.moveTo(u,t.waterLevel);for(var f=0,d=0;d<l;++d){var w=d%4,i=Oe(d*t.waveLength/4,w,t.waveLength,t.amplitude);e.bezierCurveTo(i[0][0]+u,-i[0][1]+t.waterLevel,i[1][0]+u,-i[1][1]+t.waterLevel,i[2][0]+u,-i[2][1]+t.waterLevel),d===l-1&&(f=i[2][0])}t.inverse?(e.lineTo(f+u,t.cy-t.radiusY),e.lineTo(u,t.cy-t.radiusY),e.lineTo(u,t.waterLevel)):(e.lineTo(f+u,t.cy+t.radiusY),e.lineTo(u,t.cy+t.radiusY),e.lineTo(u,t.waterLevel)),e.closePath()}});function Oe(e,t,l,c){return t===0?[[e+1/2*l/Math.PI/2,c/2],[e+1/2*l/Math.PI,c],[e+l/4,c]]:t===1?[[e+1/2*l/Math.PI/2*(Math.PI-2),c],[e+1/2*l/Math.PI/2*(Math.PI-1),c/2],[e+l/4,0]]:t===2?[[e+1/2*l/Math.PI/2,-c/2],[e+1/2*l/Math.PI,-c],[e+l/4,-c]]:[[e+1/2*l/Math.PI/2*(Math.PI-2),-c],[e+1/2*l/Math.PI/2*(Math.PI-1),-c/2],[e+l/4,0]]}var L=Se;function re(e){return e&&e.indexOf("path://")===0}ze({type:"liquidFill",render:function(e,t,l){var c=this,u=this.group;u.removeAll();var f=e.getData(),d=f.getItemModel(0),w=d.get("center"),i=d.get("radius"),M=l.getWidth(),C=l.getHeight(),Y=Math.min(M,C),B=0,x=0,F=e.get("outline.show");F&&(B=e.get("outline.borderDistance"),x=L(e.get("outline.itemStyle.borderWidth"),Y));var T=L(w[0],M),D=L(w[1],C),E,_,k,S=!1,P=e.get("shape");if(P==="container"?(S=!0,E=[M/2,C/2],_=[E[0]-x/2,E[1]-x/2],k=[L(B,M),L(B,C)],i=[Math.max(_[0]-k[0],0),Math.max(_[1]-k[1],0)]):(E=L(i,Y)/2,_=E-x/2,k=L(B,Y),i=Math.max(_-k,0)),F){var ne=U();ne.style.lineWidth=x,u.add(U())}var le=S?0:T-i,oe=S?0:D-i,A=null;u.add(se());var q=this._data,G=[];f.diff(q).add(function(a){var r=H(a,!1),n=r.shape.waterLevel;r.shape.waterLevel=S?C/2:i,ye(r,{shape:{waterLevel:n}},e),r.z2=2,N(a,r,null),u.add(r),f.setItemGraphicEl(a,r),G.push(r)}).update(function(a,r){for(var n=q.getItemGraphicEl(r),v=H(a,!1,n),s={},o=["amplitude","cx","cy","phase","radius","radiusY","waterLevel","waveLength"],g=0;g<o.length;++g){var h=o[g];v.shape.hasOwnProperty(h)&&(s[h]=v.shape[h])}for(var m={},p=["fill","opacity","shadowBlur","shadowColor"],g=0;g<p.length;++g){var h=p[g];v.style.hasOwnProperty(h)&&(m[h]=v.style[h])}S&&(s.radiusY=C/2),V(n,{shape:s,x:v.x,y:v.y},e),e.isUniversalTransitionEnabled&&e.isUniversalTransitionEnabled()?V(n,{style:m},e):n.useStyle(m);var y=n.getClipPath(),b=v.getClipPath();n.setClipPath(v.getClipPath()),n.shape.inverse=v.inverse,y&&b&&c._shape===P&&!re(P)&&V(b,{shape:y.shape},e,{isFrom:!0}),N(a,n,n),u.add(n),f.setItemGraphicEl(a,n),G.push(n)}).remove(function(a){var r=q.getItemGraphicEl(a);u.remove(r)}).execute(),d.get("label.show")&&u.add(ue(G)),this._shape=P,this._data=f;function R(a,r){if(P)if(re(P)){var n=te(P.slice(7),{}),v=n.getBoundingRect(),s=v.width,o=v.height;s>o?(o=a*2/s*o,s=a*2):(s=a*2/o*s,o=a*2);var g=r?0:T-s/2,h=r?0:D-o/2;return n=te(P.slice(7),{},new be(g,h,s,o)),r&&(n.x=-s/2,n.y=-o/2),n}else if(S){var m=r?-a[0]:T-a[0],p=r?-a[1]:D-a[1];return ae("rect",m,p,a[0]*2,a[1]*2)}else{var m=r?-a:T-a,p=r?-a:D-a;return P==="pin"?p+=a:P==="arrow"&&(p-=a),ae(P,m,p,a*2,a*2)}return new Ie({shape:{cx:r?0:T,cy:r?0:D,r:a}})}function U(){var a=R(E);return a.style.fill=null,a.setStyle(e.getModel("outline.itemStyle").getItemStyle()),a}function se(){var a=R(i);a.setStyle(e.getModel("backgroundStyle").getItemStyle()),a.style.fill=null,a.z2=5;var r=R(i);r.setStyle(e.getModel("backgroundStyle").getItemStyle()),r.style.stroke=null;var n=new K;return n.add(a),n.add(r),n}function H(a,r,n){var v=S?i[0]:i,s=S?C/2:i,o=f.getItemModel(a),g=o.getModel("itemStyle"),h=o.get("phase"),m=L(o.get("amplitude"),s*2),p=L(o.get("waveLength"),v*2),y=f.get("value",a),b=s-y*s*2;h=n?n.shape.phase:h==="auto"?a*Math.PI/4:h;var I=g.getItemStyle();if(!I.fill){var W=e.get("color"),O=a%W.length;I.fill=W[O]}var ve=v*2,z=new Be({shape:{waveLength:p,radius:v,radiusY:s,cx:ve,cy:0,waterLevel:b,amplitude:m,phase:h,inverse:r},style:I,x:T,y:D});z.shape._waterLevel=b;var $=o.getModel("emphasis.itemStyle").getItemStyle();$.lineWidth=0,z.ensureState("emphasis").style=$,we(z);var j=R(i,!0);return j.setStyle({fill:"white"}),z.setClipPath(j),z}function N(a,r,n){var v=f.getItemModel(a),s=v.get("period"),o=v.get("direction"),g=f.get("value",a),h=v.get("phase");h=n?n.shape.phase:h==="auto"?a*Math.PI/4:h;var m=function(b){var I=f.count();return I===0?b:b*(.2+(I-a)/I*.8)},p=0;s==="auto"?p=m(5e3):p=typeof s=="function"?s(g,a):s;var y=0;o==="right"||o==null?y=Math.PI:o==="left"?y=-Math.PI:o==="none"?y=0:console.error("Illegal direction value for liquid fill."),o!=="none"&&v.get("waveAnimation")&&r.animate("shape",!0).when(0,{phase:h}).when(p/2,{phase:y+h}).when(p,{phase:y*2+h}).during(function(){A&&A.dirty(!0)}).start()}function ue(a){var r=d.getModel("label");function n(){var I=e.getFormattedLabel(0,"normal"),W=f.get("value",0)*100,O=f.getName(0)||e.name;return isNaN(W)||(O=W.toFixed(0)+"%"),I==null?O:I}var v={z2:10,shape:{x:le,y:oe,width:(S?i[0]:i)*2,height:(S?i[1]:i)*2},style:{fill:"transparent"},textConfig:{position:r.get("position")||"inside"},silent:!0},s={style:{text:n(),textAlign:r.get("align"),textVerticalAlign:r.get("baseline")}};Object.assign(s.style,Re(r));var o=new Q(v),g=new Q(v);g.disableLabelAnimation=!0,o.disableLabelAnimation=!0;var h=new ee(s),m=new ee(s);o.setTextContent(h),g.setTextContent(m);var p=r.get("insideColor");m.style.fill=p;var y=new K;y.add(o),y.add(g);var b=R(i,!0);return A=new Pe({shape:{paths:a},x:T,y:D}),A.setClipPath(b),g.setClipPath(A),y}},dispose:function(){}});const Ue=Le({__name:"WaveChart",props:{component:null},setup(e){const t=e,l=Te(null);let c=.8;const{updateEchart:u,resizeHandler:f}=Me(l),{propValue:d}=Ce(t.component,()=>Z(this,null,function*(){u(w())})),w=()=>({series:[{type:"liquidFill",amplitude:d.options.amplitude,data:[c],outline:{show:d.options.outlineShow,itemStyle:{borderColor:d.options.outlineColor}},shape:d.options.shape,radius:d.options.radius,direction:d.options.direction,waveAnimation:d.options.waveAnimation,label:{show:d.options.labelShow},backgroundStyle:{color:d.options.backgroundColor},color:[d.options.color]}]});return De(()=>{u(w())}),(i,M)=>{const C=Ae("resize");return Ee((_e(),ke("div",{ref_key:"chartEl",ref:l},null,512)),[[C,xe(f)]])}}});export{Ue as default};
