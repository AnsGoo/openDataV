import{az as z,bR as F,aA as N,d as V,ar as U,as as A,ch as q,e as m,l as P,ci as H,Q as T,aG as M,cj as G,aw as Q,f as X,ag as B,o as x,c as R,b as d,z as r,u as p,aF as S,O as D,U as E,F as J,i as K,y as W,t as Y,a as L,ck as I,cl as Z,L as ee,p as ae,m as te,_ as ne}from"./index-3ca9a95a.js";import{a as se,d as ie}from"./pages-82bf68f7.js";const le=z("ellipsis",{overflow:"hidden"},[F("line-clamp",`
 white-space: nowrap;
 display: inline-block;
 vertical-align: bottom;
 max-width: 100%;
 `),N("line-clamp",`
 display: -webkit-inline-box;
 -webkit-box-orient: vertical;
 `),N("cursor-pointer",`
 cursor: pointer;
 `)]);function $(a){return`${a}-ellipsis--line-clamp`}function j(a,i){return`${a}-ellipsis--cursor-${i}`}const oe=Object.assign(Object.assign({},A.props),{expandTrigger:String,lineClamp:[Number,String],tooltip:{type:[Boolean,Object],default:!0}}),re=V({name:"Ellipsis",inheritAttrs:!1,props:oe,setup(a,{slots:i,attrs:c}){const{mergedClsPrefixRef:l}=U(a),f=A("Ellipsis","-ellipsis",le,q,a,l),h=m(null),_=m(null),w=m(null),g=m(!1),C=P(()=>{const{lineClamp:e}=a,{value:n}=g;return e!==void 0?{textOverflow:"","-webkit-line-clamp":n?"":e}:{textOverflow:n?"":"ellipsis","-webkit-line-clamp":""}});function b(){let e=!1;const{value:n}=g;if(n)return!0;const{value:s}=h;if(s){const{lineClamp:v}=a;if(y(s),v!==void 0)e=s.scrollHeight<=s.offsetHeight;else{const{value:O}=_;O&&(e=O.getBoundingClientRect().width<=s.getBoundingClientRect().width)}o(s,e)}return e}const k=P(()=>a.expandTrigger==="click"?()=>{var e;const{value:n}=g;n&&((e=w.value)===null||e===void 0||e.setShow(!1)),g.value=!n}:void 0);H(()=>{var e;a.tooltip&&((e=w.value)===null||e===void 0||e.setShow(!1))});const t=()=>T("span",Object.assign({},G(c,{class:[`${l.value}-ellipsis`,a.lineClamp!==void 0?$(l.value):void 0,a.expandTrigger==="click"?j(l.value,"pointer"):void 0],style:C.value}),{ref:"triggerRef",onClick:k.value,onMouseenter:a.expandTrigger==="click"?b:void 0}),a.lineClamp?i:T("span",{ref:"triggerInnerRef"},i));function y(e){if(!e)return;const n=C.value,s=$(l.value);a.lineClamp!==void 0?u(e,s,"add"):u(e,s,"remove");for(const v in n)e.style[v]!==n[v]&&(e.style[v]=n[v])}function o(e,n){const s=j(l.value,"pointer");a.expandTrigger==="click"&&!n?u(e,s,"add"):u(e,s,"remove")}function u(e,n,s){s==="add"?e.classList.contains(n)||e.classList.add(n):e.classList.contains(n)&&e.classList.remove(n)}return{mergedTheme:f,triggerRef:h,triggerInnerRef:_,tooltipRef:w,handleClick:k,renderTrigger:t,getTooltipDisabled:b}},render(){var a;const{tooltip:i,renderTrigger:c,$slots:l}=this;if(i){const{mergedTheme:f}=this;return T(M,Object.assign({ref:"tooltipRef",placement:"top"},i,{getDisabled:this.getTooltipDisabled,theme:f.peers.Tooltip,themeOverrides:f.peerOverrides.Tooltip}),{trigger:c,default:(a=l.tooltip)!==null&&a!==void 0?a:l.default})}else return c()}}),ce=""+new URL("default-5fefac84.png",import.meta.url).href,de=a=>(ae("data-v-e197802d"),a=a(),te(),a),ue={class:"page-list"},pe=["src","onClick"],fe={class:"options"},ge=de(()=>L("span",null,"编辑",-1)),ve=V({__name:"Pages",setup(a){const i=Q(),c=m(!1),l=m([]),f=[{key:"preview",label:"预览",icon:h("previewOpen")},{key:"delete",label:"删除",icon:h("delete")}];X(async()=>{await _()});function h(t){return()=>T(I,{name:t})}const _=async()=>{try{const t=await se();t.data&&(l.value=t.data)}catch{B.error("页面数据请求异常")}},w=async(t,y)=>{if(t==="preview")await i.push({name:"PageView",params:{index:y.id}});else if(t==="delete")try{await ie(y.id),await _()}catch(o){ee.log(o?.message||o),B.error("删除失败")}},g=async()=>{if(c.value)return!1;c.value=!0,await i.push({name:"Create"})},C=async t=>{if(c.value)return!1;c.value=!0,await i.push({name:"Editor",params:{index:t.id}})},b=async t=>{await i.push({name:"PageView",params:{index:t.id}})},k=t=>t||ce;return(t,y)=>(x(),R("div",ue,[d(p(E),null,{default:r(()=>[d(p(S),{type:"primary",loading:c.value,onClick:g},{default:r(()=>[D(" 新建 ")]),_:1},8,["loading"])]),_:1}),(x(!0),R(J,null,K(l.value,o=>(x(),R("div",{key:o.id,class:"card"},[(x(),W(p(E),{key:o.id,hoverable:""},{header:r(()=>[d(p(re),{style:{"max-width":"8rem","font-size":"1rem"}},{default:r(()=>[D(Y(o.name),1)]),_:2},1024)]),cover:r(()=>[L("img",{src:k(o.thumbnail),class:"thumbnail-image",alt:"",onClick:u=>b(o)},null,8,pe)]),action:r(()=>[L("div",fe,[d(p(M),{trigger:"hover"},{trigger:r(()=>[d(p(S),{quaternary:"",onClick:u=>C(o)},{icon:r(()=>[d(I,{name:"edit"})]),_:2},1032,["onClick"])]),default:r(()=>[ge]),_:2},1024),d(p(Z),{trigger:"hover",options:f,"show-arrow":!0,onSelect:u=>w(u,o)},{default:r(()=>[d(p(S),{quaternary:""},{icon:r(()=>[d(I,{name:"setting"})]),_:1})]),_:2},1032,["onSelect"])])]),_:2},1024))]))),128))]))}});const _e=ne(ve,[["__scopeId","data-v-e197802d"]]);export{_e as default};
