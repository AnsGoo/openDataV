import{bQ as i,bD as u,H as h,L as c,j as p}from"./index-70139cdd.js";const n={baseURL:"/",timeout:1e4,headers:{"Content-Type":"application/json;charset=UTF-8"}};function d(s){if(!s)return n;const{headers:e}=s;return e&&typeof e=="object"&&(n.headers={...n.headers,...e}),{...l(s,"headers"),...n}}function l(s,e){return Object.keys(s).filter(t=>!e.includes(t)).reduce((t,r)=>(t[r]=s[r],t),{})}class a{axiosInstance;isBlock=!1;constructor(e=!1){this.axiosInstance=i.create(d()),this.httpHookRequest(),this.httpHookResponse(),this.isBlock=e}httpHookRequest(){this.axiosInstance.interceptors.request.use(e=>{const r=u().userToken;r&&e.headers&&(e.headers.authorization=r);const o=p();return this.isBlock&&o.isEditMode?Promise.reject("http is disable where the mode is edit"):e},e=>Promise.reject(e))}httpHookResponse(){this.axiosInstance.interceptors.response.use(e=>e,e=>{const{response:t}=e;return t&&this.errorHandler(t.status,t.data.message),Promise.reject(e)})}errorHandler(e,t){switch(e){case 401:h.info("请登录后使用");break}c.log(e,t)}get(e){return this.request({...e,method:"GET"})}post(e){return this.request({...e,method:"POST"})}put(e){return this.request({...e,method:"PUT"})}patch(e){return this.request({...e,method:"PATCH"})}delete(e){return this.request({...e,method:"DELETE"})}request(e){return new Promise((t,r)=>{this.axiosInstance.request(e).then(o=>{t(o)}).catch(o=>{r(o)})})}}const f=new a(!0),k=new a(!1);export{k as a,f as h};
