var S=Object.defineProperty,D=Object.defineProperties;var x=Object.getOwnPropertyDescriptors;var f=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var b=(a,t,s)=>t in a?S(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,h=(a,t)=>{for(var s in t||(t={}))W.call(t,s)&&b(a,s,t[s]);if(f)for(var s of f(t))C.call(t,s)&&b(a,s,t[s]);return a},j=(a,t)=>D(a,x(t));var d=(a,t,s)=>new Promise((o,p)=>{var l=n=>{try{u(s.next(n))}catch(i){p(i)}},m=n=>{try{u(s.throw(n))}catch(i){p(i)}},u=n=>n.done?o(n.value):Promise.resolve(n.value).then(l,m);u((s=s.apply(a,t)).next())});import{C as F}from"./ComponentWrapper.944994bf.js";import{g as z,a as A}from"./pages.6b805928.js";import{d as B,u as I}from"./vue-router.e129948e.js";import{_ as H,p as L,f as P,e as V}from"./index.2fc0df38.js";import{p as q,r as y,c as M,q as R,o as U,x as v,y as _,F as G,a6 as J,M as N,I as O,u as K}from"./@vue.7df1a0ef.js";import"./index.59b178ec.js";import"./axios.19d3e859.js";import"./lodash-es.4775bb8f.js";import"./@vueuse.fe63d129.js";import"./pinia.685e9614.js";import"./vue-demi.b3a9cad9.js";import"./mitt.550594b0.js";import"./element-plus.54ccd689.js";import"./lodash.8679a684.js";import"./nprogress.5f640c6a.js";import"./async-validator.5d25c98b.js";import"./@popperjs.a8a4a6a0.js";import"./resize-observer-polyfill.8deb1e21.js";import"./dexie.c25c286a.js";import"./@icon-park.87123711.js";const Q=q({setup(a){const t=[],s=y([]),o=y({width:0,height:0,scale:0,dataWs:"",image:"https://cdn.jsdelivr.net/gh/AnsGoo/openDataV@gh-pages/images/bg.jpg"}),p=M(()=>{const e=j(h({},o.value),{backgroundImage:o.value.image,backgroundSize:"cover"});return P(e,["width","height","backgroundImage","backgroundSize"])}),l=B(),m=I(),u=e=>d(this,null,function*(){console.log("\u52A0\u8F7D\u901A\u7528\u7EC4\u4EF6");try{const c=yield z(e);i(c)}catch(c){m.push({name:"Error"})}}),n=()=>d(this,null,function*(){try{const e=yield A();i(e)}catch(e){m.push({name:"Error"})}}),i=e=>{e.canvasStyle&&(o.value=e.canvasStyle),e.canvasData&&(s.value=e.canvasData),o.value.dataWs&&t.push(w("actual",o.value.dataWs)),g()};R(()=>d(this,null,function*(){l.name==="Home"?yield n():yield u(l.params.index),window.addEventListener("resize",g)}));const w=(e,c)=>{const r=new WebSocket(c);return r.onopen=()=>{console.log("websocket\u8FDE\u63A5\u6210\u529F")},r.onclose=()=>{console.log("websocket\u8FDE\u63A5\u88AB\u5173\u95ED")},r.onmessage=k=>{const E=JSON.parse(k.data);V.emit(e,E)},r};U(()=>{t.forEach(e=>{console.log("\u5173\u95EDwebsocket"),e.close()}),window.removeEventListener("resize",g)});const g=()=>{const e=document.querySelector(".screen");if(e){const c=o.value.width,r=o.value.height;L(e,c,r)}};return(e,c)=>(v(),_("div",{class:"bg",style:O(K(p))},[(v(!0),_(G,null,J(s.value,r=>(v(),N(F,{key:r.id,component:r},null,8,["component"]))),128))],4))}});var fe=H(Q,[["__scopeId","data-v-4fc544a3"]]);export{fe as default};
