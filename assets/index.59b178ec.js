var l=Object.defineProperty,f=Object.defineProperties;var m=Object.getOwnPropertyDescriptors;var c=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var h=(s,e,t)=>e in s?l(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,o=(s,e)=>{for(var t in e||(e={}))k.call(e,t)&&h(s,t,e[t]);if(c)for(var t of c(e))q.call(e,t)&&h(s,t,e[t]);return s},a=(s,e)=>f(s,m(e));var i=(s,e,t)=>(h(s,typeof e!="symbol"?e+"":e,t),t);import{a as x}from"./axios.19d3e859.js";import{C as H,a as d,u as P,L as j}from"./index.2fc0df38.js";import{d as L,u as R}from"./vue-router.e129948e.js";const n={baseURL:"http://localhost:13000",timeout:1e4,headers:{"Content-Type":H.JSON}};function S(s){if(!s)return n;const{headers:e}=s;return e&&typeof e=="object"&&(n.headers=o(o({},n.headers),e)),o(o({},T(s,"headers")),n)}function T(s,e){return Object.keys(s).filter(t=>!e.includes(t)).reduce((t,r)=>(t[r]=s[r],t),{})}const b=L();class p{constructor(e=!1,t=!1){i(this,"axiosInstance");i(this,"isBlock",!1);i(this,"isLogout",!1);this.axiosInstance=x.create(S()),this.httpHookRequest(),this.httpHookResponse(),this.isBlock=e,this.isLogout=t}httpHookRequest(){this.axiosInstance.interceptors.request.use(e=>{const r=d().userToken;r&&e.headers&&(e.headers.authorization=r);const u=P();return this.isBlock&&u.isEditMode?Promise.reject("http is disable where the mode is edit"):e},e=>Promise.reject(e))}httpHookResponse(){this.axiosInstance.interceptors.response.use(e=>e.data,e=>{const{response:t}=e;return t&&this.errorHandler(t.status,t.data.message),Promise.reject(e)})}errorHandler(e,t){const r=R(),u=d();switch(e){case 401:{this.isLogout&&(u.logout(),r.push({path:j,query:{redirect:b.fullPath}}));break}case 403:{r.push({name:"403"});break}default:console.log(t)}}get(e){return this.request(a(o({},e),{method:"GET"}))}post(e){return this.request(a(o({},e),{method:"POST"}))}put(e){return this.request(a(o({},e),{method:"PUT"}))}patch(e){return this.request(a(o({},e),{method:"PATCH"}))}delete(e){return this.request(a(o({},e),{method:"DELETE"}))}request(e){return new Promise((t,r)=>{this.axiosInstance.request(e).then(u=>{t(u)}).catch(u=>{r(u)})})}}const w=new p(!0),g=new p(!1,!0);export{g as a,w as h};
