import{r as j,h as w}from"./echarts.4f9736bc.js";import{b as A}from"./@vueuse.fe63d129.js";import{h as V}from"./index.59b178ec.js";import{u as E,b as z}from"./index.2fc0df38.js";import{t as v}from"./mydark.8efe4250.js";import{d as S}from"./lodash-es.4775bb8f.js";import{p as I,r as F,q as k,w as D,o as N,y as B,x as C}from"./@vue.7df1a0ef.js";import{W as O}from"./zrender.706c9170.js";import"./tslib.34a40861.js";import"./axios.19d3e859.js";import"./vue-router.e129948e.js";import"./pinia.685e9614.js";import"./vue-demi.b3a9cad9.js";import"./mitt.550594b0.js";import"./element-plus.54ccd689.js";import"./lodash.8679a684.js";import"./nprogress.5f640c6a.js";import"./async-validator.5d25c98b.js";import"./@popperjs.a8a4a6a0.js";import"./resize-observer-polyfill.8deb1e21.js";import"./dexie.c25c286a.js";import"./@icon-park.87123711.js";const se=I({props:{element:null,propValue:null},setup(p){const i=p;j("mydark",v);const d=E(),u=F(null);let a=null,l=100,f,n=[];const x=t=>{const e=t;i.propValue.datatag&&e.TagName===i.propValue.datatag&&(l=Number(e.TagValue),c())};k(()=>{y(),clearInterval(f),g()}),z("actual",x);const h=()=>{n=[];const t=Number(i.propValue.maxValue||100),e=Number(i.propValue.splitNumber||10);for(let o=0,r=t;o<=r;o++)(o-e)%e==0?n.push("-3"):(o-e)%(e/2)==0?n.push("-1"):n.push("")},b=t=>{const e=Number(i.propValue.maxValue||100),o=e/3,r=e/3*2;let s=[];return t>o?s.push({offset:0,color:"#93FE94"},{offset:.5,color:"#E4D225"},{offset:1,color:"#E01F28"}):t>r?s.push({offset:0,color:"#93FE94"},{offset:1,color:"#E4D225"}):s.push({offset:1,color:"#93FE94"}),s};function y(){const t=Number(i.propValue.maxValue||100);V.post({url:i.propValue.history,data:[i.propValue.datatag]}).then(e=>{e.ErrorCode===200&&(l=Number(e.Results[0].TagValue)||0)}).catch(e=>{console.log(e),l=Math.round(Math.random()*t)}).finally(()=>{c()})}A(u,t=>{const e=t[0],{width:o,height:r}=e.contentRect,s=a==null?void 0:a.getOption();a==null||a.resize({width:o,height:r}),s.xAxis[3].min=-(o/2)+50,s.xAxis[3].max=o/2,a==null||a.setOption(s)});const m=()=>{const t=Number(i.propValue.maxValue||100);h();const e=b(l);let o=e[e.length-1].color;return{title:{text:"\u6E29\u5EA6\u8BA1",show:!1},yAxis:[{show:!1,data:[],min:0,max:t,axisLine:{show:!1}},{show:!1,min:0,max:t},{type:"category",data:["","","","","","","","","","","",""],axisLabel:{fontSize:20,color:"white"},axisLine:{show:!1},axisTick:{show:!1}}],xAxis:[{show:!1,min:-10,max:10,data:[]},{show:!1,min:-10,max:10,data:[]},{show:!1,min:-10,max:10,data:[]},{show:!1,min:-10,max:30}],series:[{name:"\u6761",type:"bar",xAxisIndex:0,data:[{value:l,label:{normal:{show:!0,rich:{back:{align:"center",lineHeight:50,fontSize:40,fontFamily:"digifacewide",color:o},unit:{fontFamily:"\u5FAE\u8F6F\u96C5\u9ED1",fontSize:15,lineHeight:50,color:o},downTxt:{lineHeight:50,fontSize:25,align:"center",color:"#fff"}}}}}],barWidth:10,itemStyle:{color:new O(0,1,0,0,e)},z:2},{name:"\u767D\u6846",type:"bar",xAxisIndex:1,barGap:"-100%",data:[t-20],barWidth:18,itemStyle:{color:"#0C2E6D",borderRadius:50},z:1},{name:"\u5916\u6846",type:"bar",xAxisIndex:2,barGap:"-100%",data:[t],barWidth:25,itemStyle:{color:"#4577BA",borderRadius:50},z:0},{name:"\u5706",type:"scatter",hoverAnimation:!1,data:[0],xAxisIndex:0,symbolSize:25,itemStyle:{color:"#93FE94",opacity:1},z:2},{name:"\u767D\u5706",type:"scatter",hoverAnimation:!1,data:[0],xAxisIndex:1,symbolSize:35,itemStyle:{color:"#0C2E6D",opacity:1},z:1},{name:"\u5916\u5706",type:"scatter",hoverAnimation:!1,data:[0],xAxisIndex:2,symbolSize:43,itemStyle:{color:"#4577BA",opacity:1},z:0},{name:"\u523B\u5EA6",type:"bar",yAxisIndex:0,xAxisIndex:3,label:{normal:{show:!0,position:"left",distance:1,color:"white",fontSize:12,formatter:function(s){return s.dataIndex>t||s.dataIndex<0?"":s.data==="-3"?s.dataIndex:""}}},barGap:"0%",data:n,barWidth:1,itemStyle:{color:"white",borderRadius:120},z:0}]}},c=S(()=>{const t=m();t.series[0].data[0].value=l,a&&a.setOption({series:t.series})},300),g=()=>{a=w(u.value,"mydark"),a.clear(),a.setOption(m())};return d.isEditMode&&D(()=>i.propValue,(t,e)=>{console.log(t),a&&(a.clear(),a.setOption(m()))},{deep:!0}),N(()=>{a&&(a.clear(),a.dispose())}),(t,e)=>(C(),B("div",{ref:(o,r)=>{r.chartEl=o,u.value=o}},null,512))}});export{se as default};
