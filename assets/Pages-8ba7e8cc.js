import{Y as F,bz as H,bA as N,d as j,$ as q,a1 as A,bB as z,v as m,e as O,bC as G,I as T,bD as M,bE as U,a7 as W,x as X,G as P,o as k,c as S,b as u,w as r,u as d,W as I,D,E,F as Y,f as J,l as K,C as Q,a as L,bF as R,bG as Z,L as ee,bH as te,bI as ae,_ as ne}from"./index-10d63009.js";import{a as se,d as ie}from"./pages-411fedc9.js";import"./index-448c4cac.js";const le=F("ellipsis",{overflow:"hidden"},[H("line-clamp",`
 white-space: nowrap;
 display: inline-block;
 vertical-align: bottom;
 max-width: 100%;
 `),N("line-clamp",`
 display: -webkit-inline-box;
 -webkit-box-orient: vertical;
 `),N("cursor-pointer",`
 cursor: pointer;
 `)]);function $(t){return`${t}-ellipsis--line-clamp`}function V(t,i){return`${t}-ellipsis--cursor-${i}`}const oe=Object.assign(Object.assign({},A.props),{expandTrigger:String,lineClamp:[Number,String],tooltip:{type:[Boolean,Object],default:!0}}),re=j({name:"Ellipsis",inheritAttrs:!1,props:oe,setup(t,{slots:i,attrs:c}){const{mergedClsPrefixRef:l}=q(t),f=A("Ellipsis","-ellipsis",le,z,t,l),h=m(null),_=m(null),w=m(null),g=m(!1),y=O(()=>{const{lineClamp:e}=t,{value:n}=g;return e!==void 0?{textOverflow:"","-webkit-line-clamp":n?"":e}:{textOverflow:n?"":"ellipsis","-webkit-line-clamp":""}});function C(){let e=!1;const{value:n}=g;if(n)return!0;const{value:s}=h;if(s){const{lineClamp:v}=t;if(b(s),v!==void 0)e=s.scrollHeight<=s.offsetHeight;else{const{value:B}=_;B&&(e=B.getBoundingClientRect().width<=s.getBoundingClientRect().width)}o(s,e)}return e}const x=O(()=>t.expandTrigger==="click"?()=>{var e;const{value:n}=g;n&&((e=w.value)===null||e===void 0||e.setShow(!1)),g.value=!n}:void 0);G(()=>{var e;t.tooltip&&((e=w.value)===null||e===void 0||e.setShow(!1))});const a=()=>T("span",Object.assign({},U(c,{class:[`${l.value}-ellipsis`,t.lineClamp!==void 0?$(l.value):void 0,t.expandTrigger==="click"?V(l.value,"pointer"):void 0],style:y.value}),{ref:"triggerRef",onClick:x.value,onMouseenter:t.expandTrigger==="click"?C:void 0}),t.lineClamp?i:T("span",{ref:"triggerInnerRef"},i));function b(e){if(!e)return;const n=y.value,s=$(l.value);t.lineClamp!==void 0?p(e,s,"add"):p(e,s,"remove");for(const v in n)e.style[v]!==n[v]&&(e.style[v]=n[v])}function o(e,n){const s=V(l.value,"pointer");t.expandTrigger==="click"&&!n?p(e,s,"add"):p(e,s,"remove")}function p(e,n,s){s==="add"?e.classList.contains(n)||e.classList.add(n):e.classList.contains(n)&&e.classList.remove(n)}return{mergedTheme:f,triggerRef:h,triggerInnerRef:_,tooltipRef:w,handleClick:x,renderTrigger:a,getTooltipDisabled:C}},render(){var t;const{tooltip:i,renderTrigger:c,$slots:l}=this;if(i){const{mergedTheme:f}=this;return T(M,Object.assign({ref:"tooltipRef",placement:"top"},i,{getDisabled:this.getTooltipDisabled,theme:f.peers.Tooltip,themeOverrides:f.peerOverrides.Tooltip}),{trigger:c,default:(t=l.tooltip)!==null&&t!==void 0?t:l.default})}else return c()}}),ce=""+new URL("default-5fefac84.png",import.meta.url).href,de=t=>(te("data-v-7dc7d8f5"),t=t(),ae(),t),ue={class:"page-list"},pe=["src","onClick"],fe={class:"options"},ge=de(()=>L("span",null,"编辑",-1)),ve=j({__name:"Pages",setup(t){const i=W(),c=m(!1),l=m([]),f=[{key:"preview",label:"预览",icon:h("previewOpen")},{key:"delete",label:"删除",icon:h("delete")}];X(async()=>{await _()});function h(a){return()=>T(R,{name:a})}const _=async()=>{try{const a=await se();a.data&&(l.value=a.data)}catch{P.error("页面数据请求异常")}},w=async(a,b)=>{if(a==="preview")await i.push({name:"PageView",params:{index:b.id}});else if(a==="delete")try{await ie(b.id),await _()}catch(o){ee.log(o?.message||o),P.error("删除失败")}},g=async()=>{if(c.value)return!1;c.value=!0,await i.push({name:"Create"})},y=async a=>{if(c.value)return!1;c.value=!0,await i.push({name:"Editor",params:{index:a.id}})},C=async a=>{await i.push({name:"PageView",params:{index:a.id}})},x=a=>a||ce;return(a,b)=>(k(),S("div",ue,[u(d(E),null,{default:r(()=>[u(d(I),{type:"primary",loading:c.value,onClick:g},{default:r(()=>[D(" 新建 ")]),_:1},8,["loading"])]),_:1}),(k(!0),S(Y,null,J(l.value,o=>(k(),S("div",{key:o.id,class:"card"},[(k(),K(d(E),{key:o.id,hoverable:""},{header:r(()=>[u(d(re),{style:{"max-width":"8rem","font-size":"1rem"}},{default:r(()=>[D(Q(o.name),1)]),_:2},1024)]),cover:r(()=>[L("img",{src:x(o.thumbnail),class:"thumbnail-image",alt:"",onClick:p=>C(o)},null,8,pe)]),action:r(()=>[L("div",fe,[u(d(M),{trigger:"hover"},{trigger:r(()=>[u(d(I),{quaternary:"",onClick:p=>y(o)},{icon:r(()=>[u(d(R),{name:"edit"})]),_:2},1032,["onClick"])]),default:r(()=>[ge]),_:2},1024),u(d(Z),{trigger:"hover",options:f,"show-arrow":!0,onSelect:p=>w(p,o)},{default:r(()=>[u(d(I),{quaternary:""},{icon:r(()=>[u(d(R),{name:"setting"})]),_:1})]),_:2},1032,["onSelect"])])]),_:2},1024))]))),128))]))}});const we=ne(ve,[["__scopeId","data-v-7dc7d8f5"]]);export{we as default};
